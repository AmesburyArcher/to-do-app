(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{N:()=>x,s:()=>w});const t=()=>{document.querySelector(".current-date").textContent=n()};function n(){const e=new Date;let t=1==e.getMinutes().toString().length?"0"+e.getMinutes():e.getMinutes(),n=1==e.getHours().toString().length?"0"+e.getHours():e.getHours(),o=e.getHours()>=12?"pm":"am";return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e.getDay()]+" "+["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()]+" "+e.getDate()+" "+e.getFullYear()+" "+n+":"+t+o}const o=document.querySelector("#to-do-list"),s=document.querySelector(".to-do-title"),r=document.querySelector(".task-count"),a=document.querySelector(".tasks"),c=document.querySelector("#task-template"),i=e=>{const t=e.tasks.filter((e=>!e.complete)).length,n=1===t?"task":"tasks";r.textContent=`${t} ${n} remaining`},l=()=>{const e=g.find((e=>e.id===v));null==e?o.style.display="none":(o.style.display="",s.textContent=e.name,i(e),h(a),e.tasks.forEach((e=>{const t=document.importNode(c.content,!0),n=t.querySelector("input");n.id=e.id,n.checked=e.complete,t.querySelector(".task-name").textContent=e.name;const o=t.querySelector(".task-desc");e.desc?o.textContent=` Description: ${e.desc}`:o.textContent="No Description.";const s=t.querySelector(".task-date");e.date?s.textContent=` Complete by: ${e.date}`:s.textContent="No Completion Date.",t.querySelector(".task-posted").textContent=`Posted on: ${e.posted}`,t.querySelector(".edit-task").innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="edit-task-icon" width="20" height="20" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" /><line x1="13.5" y1="6.5" x2="17.5" y2="10.5" /></svg>',a.appendChild(t)})))},d=(e,t,n,o)=>({id:Date.now().toString(),name:e,desc:t,date:n,posted:o,complete:!1}),u="task.list",m="task.selectedFolder";let v=localStorage.getItem(m),g=JSON.parse(localStorage.getItem(u))||[];const y=()=>{p(),k()},p=()=>{localStorage.setItem(u,JSON.stringify(g)),localStorage.setItem(m,v)},k=()=>{const e=document.querySelector(".directory");h(e),g.forEach((t=>{const n=x("li",null,["directory-folder"],t.name);n.dataset.listId=t.id,t.id===v&&n.classList.add("directory-active"),e.appendChild(n);const o=x("span",null,["directory-folder-icons"],null);o.innerHTML='<button class="button-edit"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-edit" width="18" height="18" viewBox="0 0 24 24" stroke-width="1.5" stroke="#ffffff" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" /><line x1="13.5" y1="6.5" x2="17.5" y2="10.5" /></svg></button><button class="button-trash"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-trash" width="18" height="18" viewBox="0 0 24 24" stroke-width="1.5" stroke="#ffffff" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="4" y1="7" x2="20" y2="7" /><line x1="10" y1="11" x2="10" y2="17" /><line x1="14" y1="11" x2="14" y2="17" /><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" /><path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" /></svg></button>',n.classList.contains("directory-active")&&n.appendChild(o)}))},h=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)},f=e=>{const t=document.querySelector(".add-dir-btn-text");e.preventDefault();const n=t.value;if(null==n||""===n)return;const o=E(n);t.value=null,g.push(o),y()},S=e=>{"li"===e.target.tagName.toLowerCase()&&(v=e.target.dataset.listId,y(),l())},L=e=>{(e.target.classList.contains("icon-trash")||e.target.classList.contains("button-trash"))&&(e.target.parentElement.parentElement.parentElement.dataset.listId!==v&&e.target.parentElement.parentElement.dataset.listId!==v||(g=g.filter((e=>e.id!==v)),v=null,w()))},q=e=>{if((e.target.classList.contains("icon-edit")||e.target.classList.contains("button-edit"))&&(e.target.parentElement.parentElement.parentElement.dataset.listId===v||e.target.parentElement.parentElement.dataset.listId===v)){const e=document.querySelector(".directory-modal-container");e.classList.toggle("active");const t=document.querySelector("#directory-edit-form"),n=document.querySelector(".icon-tabler-square-x"),o=n=>{n.preventDefault();const s=document.querySelector("#text-dir"),r=s.value;null!=r&&""!==r&&(g.forEach((e=>{e.id===v&&(e.name=r)})),s.value=null,y(),l(),e.classList.remove("active"),t.removeEventListener("submit",o))},s=()=>{e.classList.remove("active"),t.removeEventListener("submit",o),n.removeEventListener("click",s)};n.addEventListener("click",s),t.addEventListener("submit",o)}},E=e=>({id:Date.now().toString(),name:e,tasks:[]});function x(e,t,n,o){const s=document.createElement(e);return t&&(s.id=t),n&&n.forEach((e=>s.classList.add(e))),o&&(s.textContent=o),s}const w=()=>{y(),l()};setInterval(t,1e3),(()=>{const e=document.querySelector(".light-dark-mode");e.addEventListener("click",(function(){document.body.classList.toggle("active"),e.classList.toggle("active");const t=document.querySelector(".current-theme");e.classList.contains("active")?t.textContent="Dark Mode":t.textContent="Light Mode"}))})(),w(),(()=>{const e=document.querySelector("#add-dir-form"),t=document.querySelector(".directory");e.addEventListener("submit",f),t.addEventListener("click",S),t.addEventListener("click",L),t.addEventListener("click",q)})(),document.querySelector(".create-task-btn").addEventListener("click",(()=>{document.querySelector(".modal-container").classList.add("active")})),document.querySelector("#add-task").addEventListener("submit",(e=>{e.preventDefault();const t=document.querySelector(".modal-container"),o=document.querySelector("#task"),s=document.querySelector("#description"),r=document.querySelector("#date"),a=n(),c=o.value;if(null==c||""===c)return;const i=s.value,l=r.value,u=d(c,i,l,a);o.value=null,s.value=null,r.value=null,g.find((e=>e.id===v)).tasks.push(u),t.classList.remove("active"),w()})),a.addEventListener("click",(e=>{if("input"===e.target.tagName.toLowerCase()){const t=g.find((e=>e.id===v));t.tasks.find((t=>t.id===e.target.id)).complete=e.target.checked,p(),i(t)}})),a.addEventListener("click",(e=>{const t=g.find((e=>e.id===v)),n=e.target.parentNode.parentNode,o=Array.from(n.parentNode.children).indexOf(n),s=document.querySelector(".task-edit"),r=document.querySelector(".description-edit"),a=document.querySelector(".date-edit");let c=t.tasks[o];const i=document.querySelector(".modal-container-edit"),d=document.querySelector("#add-task-edit");if(e.target.classList.contains("edit-task-icon")||e.target.classList.contains("edit-task")){s.value=c.name,c.desc?r.value=c.desc:r.value="",c.date?a.value=c.date:a.value="",i.classList.add("active");const e=t=>{console.log(o),t.preventDefault(),c.name=s.value,c.desc=r.value,c.date=a.value,c="",console.log(c),i.classList.remove("active"),d.removeEventListener("submit",e),l(),p()},t=()=>{d.removeEventListener("submit",e),i.classList.remove("active"),n.removeEventListener("click",t)},n=document.querySelector(".close-task-modal-edit");n.addEventListener("click",t),d.addEventListener("submit",e)}})),document.querySelector(".delete-tasks").addEventListener("click",(()=>{const e=g.find((e=>e.id===v));e.tasks=e.tasks.filter((e=>!e.complete)),w()})),document.querySelector(".close-task-modal").addEventListener("click",(()=>{document.querySelector(".modal-container").classList.remove("active")})),t()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFDM0RMLEVBQWFOLE1BQVFNLEVBQWFOLE1BQU1DLFFBQU9DLElBQVNBLEVBQUtDLFdBQzdEaUUsT0FUa0I3RixTQUFTQyxjQUFjLHFCQUMvQnlHLGlCQUFpQixTQXlIUixLQUNEMUcsU0FBU0MsY0FBYyxvQkFDL0J3RSxVQUFVOEIsT0FBTyxhRTdIM0J4RyxLIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG8tZG8tYXBwL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3RvLWRvLWFwcC93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vdG8tZG8tYXBwL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vdG8tZG8tYXBwLy4vc3JjL2RhdGUuanMiLCJ3ZWJwYWNrOi8vdG8tZG8tYXBwLy4vc3JjL2xpc3QtY3JlYXRvci5qcyIsIndlYnBhY2s6Ly90by1kby1hcHAvLi9zcmMvZGlyZWN0b3J5LWNyZWF0b3IuanMiLCJ3ZWJwYWNrOi8vdG8tZG8tYXBwLy4vc3JjL2luZGV4LmpzIiwid2VicGFjazovL3RvLWRvLWFwcC8uL3NyYy90b2dnbGVUaGVtZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsImNvbnN0IGRpc3BsYXlEYXRlID0gKCkgPT4ge1xuICAgIGNvbnN0IGRhdGVET00gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY3VycmVudC1kYXRlJyk7XG4gICAgZGF0ZURPTS50ZXh0Q29udGVudCA9IGZvcm1hdEFNUE0oKVxufVxuXG5cbi8vIGNyZWF0ZXMgdGhlIGN1cnJlbnQgZGF0ZSBhdCB0aW1lIG9mIGV4ZWN1dGlvblxuZnVuY3Rpb24gZm9ybWF0QU1QTSgpIHtcbiAgICBjb25zdCBkID0gbmV3IERhdGUoKVxuICAgIGxldCBtaW51dGVzID0gZC5nZXRNaW51dGVzKCkudG9TdHJpbmcoKS5sZW5ndGggPT0gMSA/ICcwJytkLmdldE1pbnV0ZXMoKSA6IGQuZ2V0TWludXRlcygpO1xuICAgIGxldCBob3VycyA9IGQuZ2V0SG91cnMoKS50b1N0cmluZygpLmxlbmd0aCA9PSAxID8gJzAnK2QuZ2V0SG91cnMoKSA6IGQuZ2V0SG91cnMoKTtcbiAgICBsZXQgYW1wbSA9IGQuZ2V0SG91cnMoKSA+PSAxMiA/ICdwbScgOiAnYW0nO1xuICAgIGxldCBtb250aHMgPSBbJ0phbicsJ0ZlYicsJ01hcicsJ0FwcicsJ01heScsJ0p1bicsJ0p1bCcsJ0F1ZycsJ1NlcCcsJ09jdCcsJ05vdicsJ0RlYyddO1xuICAgIGxldCBkYXlzID0gWydTdW4nLCdNb24nLCdUdWUnLCdXZWQnLCdUaHUnLCdGcmknLCdTYXQnXTtcbiAgICByZXR1cm4gZGF5c1tkLmdldERheSgpXSsnICcrbW9udGhzW2QuZ2V0TW9udGgoKV0rJyAnK2QuZ2V0RGF0ZSgpKycgJytkLmdldEZ1bGxZZWFyKCkrJyAnK2hvdXJzKyc6JyttaW51dGVzK2FtcG07XG4gICAgfVxuXG5leHBvcnQgeyBkaXNwbGF5RGF0ZSwgZm9ybWF0QU1QTSB9IiwiaW1wb3J0IHsgY3JlYXRlSFRNTEVsZW1lbnQsIHJlbmRlciB9IGZyb20gXCIuL2luZGV4XCI7XG5pbXBvcnQgeyByZW5kZXJMaXN0cywgY3JlYXRlRGlyTGlzdGVuZXIsIHNhdmVBbmRSZW5kZXJMaXN0LCBkaXJlY3RvcnlBcnIsIHNlbGVjdGVkRm9sZGVyLCBjbGVhckxpc3QsIHNhdmUgfSBmcm9tIFwiLi9kaXJlY3RvcnktY3JlYXRvclwiO1xuaW1wb3J0IHsgZm9ybWF0QU1QTSB9IGZyb20gXCIuL2RhdGVcIjtcblxuXG5jb25zdCBmb2xkZXJEaXNwbGF5Q29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3RvLWRvLWxpc3QnKTtcbmNvbnN0IGZvbGRlclRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRvLWRvLXRpdGxlJyk7XG5jb25zdCB0YXNrQ291bnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGFzay1jb3VudCcpO1xuY29uc3QgdGFza0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50YXNrcycpO1xuY29uc3QgdGFza1RlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Rhc2stdGVtcGxhdGUnKTtcblxuLy8gY3JlYXRlcyBsaXN0ZW5lcnMgZm9yIHRhc2tzXG5jb25zdCBsaXN0TGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIGNvbnN0IGNyZWF0ZVRhc2tCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY3JlYXRlLXRhc2stYnRuJyk7XG4gICAgY3JlYXRlVGFza0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNyZWF0ZVRhc2tNb2RhbClcblxuICAgIGNvbnN0IHN1Ym1pdFRhc2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYWRkLXRhc2snKTtcbiAgICBzdWJtaXRUYXNrLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHN1Ym1pdEZvcm0pO1xuXG4gICAgLy9jaGVjayBpZiBjb21wbGV0ZVxuICAgIHRhc2tDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0YXNrQ2hlY2spO1xuXG4gICAgLy9lZGl0IHRhc2tcbiAgICB0YXNrQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZWRpdFRhc2tEZXRhaWxzKTtcblxuICAgIGNvbnN0IGRlbGV0ZVRhc2tzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRlbGV0ZS10YXNrcycpO1xuICAgIGRlbGV0ZVRhc2tzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZGVsZXRlU2VsZWN0ZWRUYXNrcylcblxuICAgIGNvbnN0IGNsb3NlVGFzayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jbG9zZS10YXNrLW1vZGFsJyk7XG4gICAgY2xvc2VUYXNrLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VUYXNrTW9kYWwpO1xuICAgIFxufVxuXG4vLyBkZWxldGVzIHNlbGVjdGVkIHRhc2tzXG5jb25zdCBkZWxldGVTZWxlY3RlZFRhc2tzID0gKCkgPT4ge1xuICAgIGNvbnN0IHNlbGVjdGVkTGlzdCA9IGRpcmVjdG9yeUFyci5maW5kKGxpc3QgPT4gbGlzdC5pZCA9PT0gc2VsZWN0ZWRGb2xkZXIpO1xuICAgIHNlbGVjdGVkTGlzdC50YXNrcyA9IHNlbGVjdGVkTGlzdC50YXNrcy5maWx0ZXIodGFzayA9PiAhdGFzay5jb21wbGV0ZSk7XG4gICAgcmVuZGVyKCk7XG59XG5cbi8vIGNoZWNrcyBpZiB0YXNrIGlzIG1hcmtlZCBjb21wbGV0ZVxuY29uc3QgdGFza0NoZWNrID0gKGUpID0+IHtcbiAgICBpZihlLnRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdpbnB1dCcpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRMaXN0ID0gZGlyZWN0b3J5QXJyLmZpbmQobGlzdCA9PiBsaXN0LmlkID09PSBzZWxlY3RlZEZvbGRlcik7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkVGFzayA9IHNlbGVjdGVkTGlzdC50YXNrcy5maW5kKHRhc2sgPT4gdGFzay5pZCA9PT0gZS50YXJnZXQuaWQpIFxuICAgICAgICBzZWxlY3RlZFRhc2suY29tcGxldGUgPSBlLnRhcmdldC5jaGVja2VkO1xuICAgICAgICBzYXZlKCk7XG4gICAgICAgIHJlbmRlclRhc2tOdW0oc2VsZWN0ZWRMaXN0KTtcbiAgICB9XG59XG5cbi8vIHJlbmRlcnMgYW5kIGRpc3BsYXlzIHRvIERPTSBudW1iZXIgb2YgdGFza3MgcmVtYWluaW5nIHRvIGNvbXBsZXRlXG5jb25zdCByZW5kZXJUYXNrTnVtID0gKHNlbGVjdGVkVGFza051bSkgPT4ge1xuICAgIGNvbnN0IGluY29tcGxldGUgPSBzZWxlY3RlZFRhc2tOdW0udGFza3MuZmlsdGVyKHRhc2sgPT4gIXRhc2suY29tcGxldGUpLmxlbmd0aDtcbiAgICBjb25zdCB0YXNrc1N0cmluZyA9IGluY29tcGxldGUgPT09IDEgPyBcInRhc2tcIiA6IFwidGFza3NcIjtcbiAgICB0YXNrQ291bnQudGV4dENvbnRlbnQgPSBgJHtpbmNvbXBsZXRlfSAke3Rhc2tzU3RyaW5nfSByZW1haW5pbmdgO1xufVxuXG4vLyBmdW5jdGlvbiB1c2VkIHRvIGNyZWF0ZSB0aGUgdGFzayBlbGVtZW50IGZvciB0aGUgRE9NXG5jb25zdCByZW5kZXJUYXNrTGlzdCA9IChzZWxlY3RlZFRhc2tMaXN0KSA9PiB7XG4gICAgc2VsZWN0ZWRUYXNrTGlzdC50YXNrcy5mb3JFYWNoKHRhc2sgPT4ge1xuICAgICAgICBjb25zdCB0YXNrRE9NID0gZG9jdW1lbnQuaW1wb3J0Tm9kZSh0YXNrVGVtcGxhdGUuY29udGVudCwgdHJ1ZSlcbiAgICAgICAgY29uc3QgY2hlY2tCb3ggPSB0YXNrRE9NLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0Jyk7XG4gICAgICAgIGNoZWNrQm94LmlkID0gdGFzay5pZDtcbiAgICAgICAgY2hlY2tCb3guY2hlY2tlZCA9IHRhc2suY29tcGxldGU7XG4gICAgICAgIGNvbnN0IHRhc2tOYW1lID0gIHRhc2tET00ucXVlcnlTZWxlY3RvcignLnRhc2stbmFtZScpO1xuICAgICAgICB0YXNrTmFtZS50ZXh0Q29udGVudCA9IHRhc2submFtZTtcblxuICAgICAgICBjb25zdCB0YXNrRGVzYyA9IHRhc2tET00ucXVlcnlTZWxlY3RvcignLnRhc2stZGVzYycpXG4gICAgICAgIHRhc2suZGVzYyA/IHRhc2tEZXNjLnRleHRDb250ZW50ID0gYCBEZXNjcmlwdGlvbjogJHt0YXNrLmRlc2N9YCA6IHRhc2tEZXNjLnRleHRDb250ZW50ID0gJ05vIERlc2NyaXB0aW9uLic7XG4gICAgICAgXG4gICAgICAgIGNvbnN0IHRhc2tEYXRlID0gdGFza0RPTS5xdWVyeVNlbGVjdG9yKCcudGFzay1kYXRlJyk7XG4gICAgICAgIHRhc2suZGF0ZSA/IHRhc2tEYXRlLnRleHRDb250ZW50ID0gYCBDb21wbGV0ZSBieTogJHt0YXNrLmRhdGV9YCA6IHRhc2tEYXRlLnRleHRDb250ZW50ID0gJ05vIENvbXBsZXRpb24gRGF0ZS4nO1xuXG4gICAgICAgIGNvbnN0IHRhc2tQb3N0ZWQgPSB0YXNrRE9NLnF1ZXJ5U2VsZWN0b3IoJy50YXNrLXBvc3RlZCcpO1xuICAgICAgICB0YXNrUG9zdGVkLnRleHRDb250ZW50ID0gYFBvc3RlZCBvbjogJHt0YXNrLnBvc3RlZH1gO1xuXG4gICAgICAgIGNvbnN0IGVkaXRUYXNrID0gdGFza0RPTS5xdWVyeVNlbGVjdG9yKCcuZWRpdC10YXNrJyk7XG4gICAgICAgIGVkaXRUYXNrLmlubmVySFRNTCA9ICc8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBjbGFzcz1cImVkaXQtdGFzay1pY29uXCIgd2lkdGg9XCIyMFwiIGhlaWdodD1cIjIwXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHN0cm9rZS13aWR0aD1cIjEuNVwiIHN0cm9rZT1cIiMwMDAwMDBcIiBmaWxsPVwibm9uZVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPjxwYXRoIHN0cm9rZT1cIm5vbmVcIiBkPVwiTTAgMGgyNHYyNEgwelwiIGZpbGw9XCJub25lXCIvPjxwYXRoIGQ9XCJNNCAyMGg0bDEwLjUgLTEwLjVhMS41IDEuNSAwIDAgMCAtNCAtNGwtMTAuNSAxMC41djRcIiAvPjxsaW5lIHgxPVwiMTMuNVwiIHkxPVwiNi41XCIgeDI9XCIxNy41XCIgeTI9XCIxMC41XCIgLz48L3N2Zz4nXG5cbiAgICAgICAgdGFza0NvbnRhaW5lci5hcHBlbmRDaGlsZCh0YXNrRE9NKTtcbiAgICB9KVxuICAgIFxufVxuXG5jb25zdCBlZGl0VGFza0RldGFpbHMgPSAoZSkgPT4ge1xuXG4gICAgY29uc3Qgc2VsZWN0ZWRMaXN0ID0gZGlyZWN0b3J5QXJyLmZpbmQobGlzdCA9PiBsaXN0LmlkID09PSBzZWxlY3RlZEZvbGRlcik7IFxuICAgIGNvbnN0IHNlbGVjdGVkRWxlbWVudCA9IGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZTtcbiAgICBjb25zdCBzZWxlY3RlZFRhc2sgPSBBcnJheS5mcm9tKHNlbGVjdGVkRWxlbWVudC5wYXJlbnROb2RlLmNoaWxkcmVuKS5pbmRleE9mKHNlbGVjdGVkRWxlbWVudClcblxuICAgIGNvbnN0IHRhc2tJbnB1dE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGFzay1lZGl0Jyk7XG4gICAgY29uc3QgdGFza0lucHV0RGVzYyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbi1lZGl0Jyk7XG4gICAgY29uc3QgdGFza0lucHV0RGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kYXRlLWVkaXQnKTtcblxuICAgIGxldCBpdGVtcyA9IHNlbGVjdGVkTGlzdC50YXNrc1tzZWxlY3RlZFRhc2tdO1xuICAgIGNvbnN0IHRhc2tFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtY29udGFpbmVyLWVkaXQnKTtcbiAgICBjb25zdCB0YXNrRWRpdEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYWRkLXRhc2stZWRpdCcpO1xuXG4gICAgaWYoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlZGl0LXRhc2staWNvbicpIHx8IGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZWRpdC10YXNrJykpIHtcbiAgICAgICB0YXNrSW5wdXROYW1lLnZhbHVlID0gaXRlbXMubmFtZTtcbiAgICAgICBpdGVtcy5kZXNjID8gdGFza0lucHV0RGVzYy52YWx1ZSA9IGl0ZW1zLmRlc2MgOiB0YXNrSW5wdXREZXNjLnZhbHVlID0gJyc7XG4gICAgICAgaXRlbXMuZGF0ZSA/IHRhc2tJbnB1dERhdGUudmFsdWUgPSBpdGVtcy5kYXRlIDogdGFza0lucHV0RGF0ZS52YWx1ZSA9ICcnO1xuICAgICAgIFxuICAgICAgIHRhc2tFZGl0TW9kYWwuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gICAgICAgXG4gICAgICAgIGNvbnN0IHN1Ym1pdFRhc2tFZGl0ID0gKGUpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHNlbGVjdGVkVGFzaylcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGl0ZW1zLm5hbWUgPSB0YXNrSW5wdXROYW1lLnZhbHVlO1xuICAgICAgICAgICAgaXRlbXMuZGVzYyA9IHRhc2tJbnB1dERlc2MudmFsdWU7XG4gICAgICAgICAgICBpdGVtcy5kYXRlID0gdGFza0lucHV0RGF0ZS52YWx1ZTtcbiAgICAgICAgICAgIGl0ZW1zID0gJyc7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhpdGVtcyk7XG4gICAgICAgICAgICB0YXNrRWRpdE1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgdGFza0VkaXRGb3JtLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHN1Ym1pdFRhc2tFZGl0KTtcbiAgICAgICAgICAgIHJlbmRlclRhc2tzKCk7XG4gICAgICAgICAgICBzYXZlKCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjbG9zZUVkaXRUYXNrID0gKCkgPT4ge1xuICAgICAgICAgICAgdGFza0VkaXRGb3JtLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHN1Ym1pdFRhc2tFZGl0KTtcbiAgICAgICAgICAgIHRhc2tFZGl0TW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG4gICAgICAgICAgICBjbG9zZUVkaXRUYXNrTW9kYWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZUVkaXRUYXNrKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNsb3NlRWRpdFRhc2tNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jbG9zZS10YXNrLW1vZGFsLWVkaXQnKTtcbiAgICAgICAgY2xvc2VFZGl0VGFza01vZGFsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VFZGl0VGFzaylcblxuICAgICAgIHRhc2tFZGl0Rm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBzdWJtaXRUYXNrRWRpdClcbiAgICB9XG5cbn1cblxuLy8gcmVuZGVycyB0aGUgdGFza3MgZnJvbSB0aGUgc2VsZWN0ZWQgZm9sZGVyIG9uIHRoZSBzY3JlZW5cbmNvbnN0IHJlbmRlclRhc2tzID0gKCkgPT4ge1xuICAgIGNvbnN0IHNlbGVjdGVkTGlzdCA9IGRpcmVjdG9yeUFyci5maW5kKGxpc3QgPT4gbGlzdC5pZCA9PT0gc2VsZWN0ZWRGb2xkZXIpO1xuXG4gICAgaWYoc2VsZWN0ZWRMaXN0ID09IG51bGwpIHtcbiAgICAgICAgZm9sZGVyRGlzcGxheUNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGZvbGRlckRpc3BsYXlDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgICAgICBmb2xkZXJUaXRsZS50ZXh0Q29udGVudCA9IHNlbGVjdGVkTGlzdC5uYW1lO1xuICAgICAgICByZW5kZXJUYXNrTnVtKHNlbGVjdGVkTGlzdCk7XG4gICAgICAgIGNsZWFyTGlzdCh0YXNrQ29udGFpbmVyKTtcbiAgICAgICAgcmVuZGVyVGFza0xpc3Qoc2VsZWN0ZWRMaXN0KTtcbiAgICB9XG59XG5cbi8vIGNsb3NlcyB0aGUgdGFzayBtb2RhbCB3aXRoIGNsaWNrIG9mIGJ1dHRvblxuY29uc3QgY2xvc2VUYXNrTW9kYWwgPSAoKSA9PiB7XG4gICAgY29uc3QgbGlzdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWNvbnRhaW5lcicpXG4gICAgbGlzdE1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xufVxuXG4vLyBmdW5jdGlvbiB0aGF0IGRpc3BsYXlzIG1vZGFsIHRvIGFkZCBuZXcgdGFza1xuY29uc3QgY3JlYXRlVGFza01vZGFsID0gKCkgPT4ge1xuICAgIGNvbnN0IGxpc3RNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1jb250YWluZXInKVxuICAgIGxpc3RNb2RhbC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcbn1cblxuLy8gZnVuY3Rpb24gdGhhdCBwcm9jZXNzZXMgdGhlIGlucHV0IGZyb20gdGhlIGNyZWF0ZSB0YXNrIG1vZGFsIGFuZCBzdWJtaXRzIGl0IGZvciBzdG9yYWdlIGFuZCBkaXNwbGF5XG5jb25zdCBzdWJtaXRGb3JtID0gKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgbGlzdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWNvbnRhaW5lcicpXG4gICAgY29uc3QgdGFza0lucHV0TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0YXNrJyk7XG4gICAgY29uc3QgdGFza0lucHV0RGVzYyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNkZXNjcmlwdGlvbicpO1xuICAgIGNvbnN0IHRhc2tJbnB1dERhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZGF0ZScpO1xuICAgIGNvbnN0IHRhc2tQb3N0ZWQgPSBmb3JtYXRBTVBNKCk7XG4gICAgXG4gICAgY29uc3QgdGFza05hbWUgPSB0YXNrSW5wdXROYW1lLnZhbHVlO1xuICAgIGlmKHRhc2tOYW1lID09IG51bGwgfHwgdGFza05hbWUgPT09ICcnKSByZXR1cm47XG4gICAgY29uc3QgdGFza0Rlc2MgPSB0YXNrSW5wdXREZXNjLnZhbHVlO1xuICAgIGNvbnN0IHRhc2tEYXRlID0gdGFza0lucHV0RGF0ZS52YWx1ZVxuICAgIGNvbnN0IHRhc2sgPSBjcmVhdGVUYXNrKHRhc2tOYW1lLCB0YXNrRGVzYywgdGFza0RhdGUsIHRhc2tQb3N0ZWQpO1xuICAgIHRhc2tJbnB1dE5hbWUudmFsdWUgPSBudWxsO1xuICAgIHRhc2tJbnB1dERlc2MudmFsdWUgPSBudWxsO1xuICAgIHRhc2tJbnB1dERhdGUudmFsdWUgPSBudWxsO1xuICAgIGNvbnN0IHNlbGVjdGVkTGlzdCA9IGRpcmVjdG9yeUFyci5maW5kKGxpc3QgPT4gbGlzdC5pZCA9PT0gc2VsZWN0ZWRGb2xkZXIpO1xuICAgIHNlbGVjdGVkTGlzdC50YXNrcy5wdXNoKHRhc2spO1xuICAgIGxpc3RNb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgICByZW5kZXIoKTtcbn1cblxuLy8gdGhpcyBmdW5jdGlvbiBjcmVhdGVzIHRoZSB0YXNrIG9iamVjdCB0byBiZSBwdXNoZWQgaW50byB0aGUgZGlyZWN0b3J5QXJyLnRhc2tzIGFycmF5XG5jb25zdCBjcmVhdGVUYXNrID0gKHRhc2ssIGRlc2MsIGRhdGUsIHBvc3RlZCkgPT4ge1xuICAgIHJldHVybiB7ICBpZDogRGF0ZS5ub3coKS50b1N0cmluZygpLCBuYW1lOiB0YXNrLCBkZXNjOiBkZXNjLCBkYXRlOiBkYXRlLCBwb3N0ZWQ6IHBvc3RlZCwgY29tcGxldGU6IGZhbHNlLCAgfVxufVxuXG5cbmV4cG9ydCB7IHJlbmRlclRhc2tzLCBsaXN0TGlzdGVuZXJzIH0iLCJpbXBvcnQgeyBjcmVhdGVIVE1MRWxlbWVudCwgcmVuZGVyIH0gZnJvbSBcIi4vaW5kZXhcIjtcbmltcG9ydCB7IHJlbmRlclRhc2tzIH0gZnJvbSBcIi4vbGlzdC1jcmVhdG9yXCI7XG5cbmNvbnN0IExPQ0FMX1NUT1JBR0VfRElSX0tFWSA9ICd0YXNrLmxpc3QnO1xuY29uc3QgTE9DQUxfU1RPUkFHRV9GT0xERVJfS0VZID0gJ3Rhc2suc2VsZWN0ZWRGb2xkZXInO1xuXG4vL2xvY2FsIHN0b3JhZ2Uga2V5cyArIGFycmF5XG5sZXQgc2VsZWN0ZWRGb2xkZXIgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShMT0NBTF9TVE9SQUdFX0ZPTERFUl9LRVkpXG5sZXQgZGlyZWN0b3J5QXJyID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShMT0NBTF9TVE9SQUdFX0RJUl9LRVkpKSB8fCBbXTsgXG5cbmNvbnN0IHNhdmVBbmRSZW5kZXJMaXN0ID0gKCkgPT4ge1xuICAgIHNhdmUoKTtcbiAgICByZW5kZXJMaXN0cygpO1xufVxuXG4vL3NhdmVzIHRvIGxvY2FsIHN0b3JhZ2VcbmNvbnN0IHNhdmUgPSAoKSA9PiB7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oTE9DQUxfU1RPUkFHRV9ESVJfS0VZLCBKU09OLnN0cmluZ2lmeShkaXJlY3RvcnlBcnIpKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShMT0NBTF9TVE9SQUdFX0ZPTERFUl9LRVksIHNlbGVjdGVkRm9sZGVyKTtcbn1cblxuLy9yZW5kZXJzIHRoZSBkaXJlY3RvcnkgbGlzdFxuY29uc3QgcmVuZGVyTGlzdHMgPSAoKSA9PiB7XG4gICAgY29uc3QgZGlyZWN0b3J5Q29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRpcmVjdG9yeScpO1xuXG4gICAgY2xlYXJMaXN0KGRpcmVjdG9yeUNvbnRhaW5lcik7XG4gICAgZGlyZWN0b3J5QXJyLmZvckVhY2goZGlyZWN0b3J5ID0+IHtcbiAgICAgICBjb25zdCBkaXJlY3RvcnlGb2xkZXIgPSBjcmVhdGVIVE1MRWxlbWVudCgnbGknLCBudWxsLCBbJ2RpcmVjdG9yeS1mb2xkZXInXSwgZGlyZWN0b3J5Lm5hbWUpXG4gICAgICAgZGlyZWN0b3J5Rm9sZGVyLmRhdGFzZXQubGlzdElkID0gZGlyZWN0b3J5LmlkO1xuICAgICAgIC8vaWYgdGhlIGZvbGRlciBpcyBzZWxlY3RlZCwgbWFrZSBpdCBhY3RpdmUgZm9sZGVyXG4gICAgICAgaWYoZGlyZWN0b3J5LmlkID09PSBzZWxlY3RlZEZvbGRlcikge1xuICAgICAgICAgICBkaXJlY3RvcnlGb2xkZXIuY2xhc3NMaXN0LmFkZCgnZGlyZWN0b3J5LWFjdGl2ZScpO1xuICAgICAgIH07XG4gICAgICAgZGlyZWN0b3J5Q29udGFpbmVyLmFwcGVuZENoaWxkKGRpcmVjdG9yeUZvbGRlcik7IFxuXG4gICAgICAgY29uc3QgZGlyZWN0b3J5Rm9sZGVySWNvbnMgPSBjcmVhdGVIVE1MRWxlbWVudCgnc3BhbicsIG51bGwsIFsnZGlyZWN0b3J5LWZvbGRlci1pY29ucyddLCBudWxsKTtcbiAgICAgICBkaXJlY3RvcnlGb2xkZXJJY29ucy5pbm5lckhUTUwgPSAnPGJ1dHRvbiBjbGFzcz1cImJ1dHRvbi1lZGl0XCI+PHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgY2xhc3M9XCJpY29uIGljb24tZWRpdFwiIHdpZHRoPVwiMThcIiBoZWlnaHQ9XCIxOFwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBzdHJva2Utd2lkdGg9XCIxLjVcIiBzdHJva2U9XCIjZmZmZmZmXCIgZmlsbD1cIm5vbmVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj48cGF0aCBzdHJva2U9XCJub25lXCIgZD1cIk0wIDBoMjR2MjRIMHpcIiBmaWxsPVwibm9uZVwiLz48cGF0aCBkPVwiTTQgMjBoNGwxMC41IC0xMC41YTEuNSAxLjUgMCAwIDAgLTQgLTRsLTEwLjUgMTAuNXY0XCIgLz48bGluZSB4MT1cIjEzLjVcIiB5MT1cIjYuNVwiIHgyPVwiMTcuNVwiIHkyPVwiMTAuNVwiIC8+PC9zdmc+PC9idXR0b24+PGJ1dHRvbiBjbGFzcz1cImJ1dHRvbi10cmFzaFwiPjxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIGNsYXNzPVwiaWNvbiBpY29uLXRyYXNoXCIgd2lkdGg9XCIxOFwiIGhlaWdodD1cIjE4XCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHN0cm9rZS13aWR0aD1cIjEuNVwiIHN0cm9rZT1cIiNmZmZmZmZcIiBmaWxsPVwibm9uZVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPjxwYXRoIHN0cm9rZT1cIm5vbmVcIiBkPVwiTTAgMGgyNHYyNEgwelwiIGZpbGw9XCJub25lXCIvPjxsaW5lIHgxPVwiNFwiIHkxPVwiN1wiIHgyPVwiMjBcIiB5Mj1cIjdcIiAvPjxsaW5lIHgxPVwiMTBcIiB5MT1cIjExXCIgeDI9XCIxMFwiIHkyPVwiMTdcIiAvPjxsaW5lIHgxPVwiMTRcIiB5MT1cIjExXCIgeDI9XCIxNFwiIHkyPVwiMTdcIiAvPjxwYXRoIGQ9XCJNNSA3bDEgMTJhMiAyIDAgMCAwIDIgMmg4YTIgMiAwIDAgMCAyIC0ybDEgLTEyXCIgLz48cGF0aCBkPVwiTTkgN3YtM2ExIDEgMCAwIDEgMSAtMWg0YTEgMSAwIDAgMSAxIDF2M1wiIC8+PC9zdmc+PC9idXR0b24+JztcbiAgICAgICAvL2lmIHRoZSBmb2xkZXIgaXMgc2VsZWN0ZWQsIGFkZCB0aGUgaWNvbnNcbiAgICAgICBpZihkaXJlY3RvcnlGb2xkZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdkaXJlY3RvcnktYWN0aXZlJykpIHtcbiAgICAgICBkaXJlY3RvcnlGb2xkZXIuYXBwZW5kQ2hpbGQoZGlyZWN0b3J5Rm9sZGVySWNvbnMpO1xuICAgICAgIH07XG4gICAgfSlcbn07XG5cbi8vY2xlYXJzIHRoZSBkaXJlY3RvcnkgbGlzdCB0byBiZSByZS1yZW5kZXJlZCBpbiByZW5kZXJMaXN0c1xuY29uc3QgY2xlYXJMaXN0ID0gKGxpc3QpID0+IHtcbiAgICB3aGlsZShsaXN0LmZpcnN0Q2hpbGQpIHtcbiAgICAgICAgbGlzdC5yZW1vdmVDaGlsZChsaXN0LmZpcnN0Q2hpbGQpXG4gICAgfVxufTtcblxuLy9hZGRzIGV2ZW50bGlzdGVuZXJzIGZvciB0aGUgZGlyZWN0b3J5XG5jb25zdCBjcmVhdGVEaXJMaXN0ZW5lciA9ICgpID0+IHtcbiAgICBjb25zdCBkaXJGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2FkZC1kaXItZm9ybScpO1xuICAgIGNvbnN0IGRpckNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kaXJlY3RvcnknKTtcblxuICAgIGRpckZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgY3JlYXRlRGlyZWN0b3J5KVxuICAgIGRpckNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNlbGVjdGVkRGlyZWN0b3J5TGlzdGVuZXIpXG4gICAgZGlyQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZGVsZXRlRGlyKVxuICAgIGRpckNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGVkaXREaXIpXG59XG5cbi8vY3JlYXRlcyBhIG5ldyBkaXJlY3RvcnkgZm9sZGVyXG5jb25zdCBjcmVhdGVEaXJlY3RvcnkgPSAoZSkgPT4ge1xuICAgIGNvbnN0IGRpclRleHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkLWRpci1idG4tdGV4dCcpO1xuXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNvbnN0IGRpck5hbWUgPSBkaXJUZXh0LnZhbHVlO1xuICAgIGlmKGRpck5hbWUgPT0gbnVsbCB8fCBkaXJOYW1lID09PSAnJykgcmV0dXJuO1xuICAgIGNvbnN0IGRpcmVjdG9yeSA9IGNyZWF0ZU5ld0RpcihkaXJOYW1lKTtcbiAgICBkaXJUZXh0LnZhbHVlID0gbnVsbDtcbiAgICBkaXJlY3RvcnlBcnIucHVzaChkaXJlY3RvcnkpO1xuICAgIHNhdmVBbmRSZW5kZXJMaXN0KCk7XG59XG5cbi8vZnVuY3Rpb24gZm9yIHRoZSBzZWxlY3RlZCBkaXJlY3RvcnkgbGlzdGVuZXJcbmNvbnN0IHNlbGVjdGVkRGlyZWN0b3J5TGlzdGVuZXIgPSAoZSkgPT4ge1xuICAgIGlmKGUudGFyZ2V0LnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2xpJykge1xuICAgICAgICBzZWxlY3RlZEZvbGRlciA9IGUudGFyZ2V0LmRhdGFzZXQubGlzdElkO1xuICAgICAgICBzYXZlQW5kUmVuZGVyTGlzdCgpO1xuICAgICAgICByZW5kZXJUYXNrcygpO1xuICAgIH1cbn1cblxuLy9mdW5jdGlvbiBmb3IgdGhlIGRlbGV0ZWRpciBsaXN0ZW5lciBcbmNvbnN0IGRlbGV0ZURpciA9IChlKSA9PiB7XG4gICAgaWYoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdpY29uLXRyYXNoJykgfHwgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdidXR0b24tdHJhc2gnKSkge1xuICAgICAgICBpZihlLnRhcmdldC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5kYXRhc2V0Lmxpc3RJZCA9PT0gc2VsZWN0ZWRGb2xkZXIgfHwgZS50YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LmRhdGFzZXQubGlzdElkID09PSBzZWxlY3RlZEZvbGRlcikge1xuICAgICAgICBkaXJlY3RvcnlBcnIgPSBkaXJlY3RvcnlBcnIuZmlsdGVyKGRpcmVjdG9yeSA9PiBkaXJlY3RvcnkuaWQgIT09IHNlbGVjdGVkRm9sZGVyKTtcbiAgICAgICAgc2VsZWN0ZWRGb2xkZXIgPSBudWxsO1xuICAgICAgICByZW5kZXIoKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbi8vRWRpdGluZyB0aGUgZGlyZWN0b3J5IGZvbGRlciB0aXRsZSBhbmQgdXBkYXRpbmcgdGhlIGFycmF5ICsgRE9NXG5jb25zdCBlZGl0RGlyID0gKGUpID0+IHtcbiAgICBpZihlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2ljb24tZWRpdCcpIHx8IGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnYnV0dG9uLWVkaXQnKSkge1xuICAgICAgICBpZihlLnRhcmdldC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5kYXRhc2V0Lmxpc3RJZCA9PT0gc2VsZWN0ZWRGb2xkZXIgfHwgZS50YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LmRhdGFzZXQubGlzdElkID09PSBzZWxlY3RlZEZvbGRlcikge1xuICAgICAgICBjb25zdCBkaXJlY3RvcnlNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kaXJlY3RvcnktbW9kYWwtY29udGFpbmVyJyk7XG4gICAgICAgIGRpcmVjdG9yeU1vZGFsLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScpO1xuICAgICAgICBjb25zdCBlZGl0RGlyQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2RpcmVjdG9yeS1lZGl0LWZvcm0nKTtcbiAgICAgICAgY29uc3QgY2xvc2VFZGl0RGlyQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmljb24tdGFibGVyLXNxdWFyZS14Jyk7XG5cbiAgICAgICAgY29uc3QgZWRpdERpckZvcm0gPSAoZSkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgY29uc3QgZGlyZWN0b3J5TW9kYWxUZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3RleHQtZGlyJyk7XG4gICAgICAgICAgICBjb25zdCBkaXJlY3RvcnlSZU5hbWUgPSBkaXJlY3RvcnlNb2RhbFRleHQudmFsdWU7XG4gICAgICAgICAgICBpZihkaXJlY3RvcnlSZU5hbWUgPT0gbnVsbCB8fCBkaXJlY3RvcnlSZU5hbWUgPT09ICcnKSByZXR1cm47XG4gICAgICAgICAgICBkaXJlY3RvcnlBcnIuZm9yRWFjaChkaXIgPT4ge1xuICAgICAgICAgICAgICAgIGlmKGRpci5pZCA9PT0gc2VsZWN0ZWRGb2xkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgZGlyLm5hbWUgPSBkaXJlY3RvcnlSZU5hbWVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgZGlyZWN0b3J5TW9kYWxUZXh0LnZhbHVlID0gbnVsbDtcbiAgICAgICAgICAgIHNhdmVBbmRSZW5kZXJMaXN0KCk7XG4gICAgICAgICAgICByZW5kZXJUYXNrcygpO1xuICAgICAgICAgICAgZGlyZWN0b3J5TW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG4gICAgICAgICAgICBlZGl0RGlyQnRuLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGVkaXREaXJGb3JtKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNsb3NlRWRpdERpciA9ICgpID0+IHtcbiAgICAgICAgICAgIGRpcmVjdG9yeU1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgZWRpdERpckJ0bi5yZW1vdmVFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBlZGl0RGlyRm9ybSk7XG4gICAgICAgICAgICBjbG9zZUVkaXREaXJCdG4ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZUVkaXREaXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgY2xvc2VFZGl0RGlyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VFZGl0RGlyKTtcbiAgICAgICAgZWRpdERpckJ0bi5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBlZGl0RGlyRm9ybSk7XG4gICAgfVxuICAgIH1cbiAgICBcblxufVxuXG4vL2NyZWF0ZXMgYSBkaXJlY3RvcnkgZm9sZGVyIG9iamVjdCB0byBiZSBwdXNoZWQgaW50byBkaXJlY3RvcnkgYXJyYXlcbmNvbnN0IGNyZWF0ZU5ld0RpciA9IChkaXIpID0+IHtcbiAgIHJldHVybiB7IGlkOiBEYXRlLm5vdygpLnRvU3RyaW5nKCksIG5hbWU6IGRpciwgdGFza3M6IFtdIH1cbn1cblxuZXhwb3J0IHsgcmVuZGVyTGlzdHMsIGNyZWF0ZURpckxpc3RlbmVyLCBzYXZlQW5kUmVuZGVyTGlzdCwgZGlyZWN0b3J5QXJyLCBzZWxlY3RlZEZvbGRlciwgY2xlYXJMaXN0LCBzYXZlIH0iLCJpbXBvcnQgeyBjcmVhdGVEaXJMaXN0ZW5lciwgc2F2ZUFuZFJlbmRlckxpc3QsIHJlbmRlckxpc3RzLCBkaXJlY3RvcnlBcnIsIHNlbGVjdGVkRm9sZGVyIH0gZnJvbSBcIi4vZGlyZWN0b3J5LWNyZWF0b3JcIjtcbmltcG9ydCB7IHRvZ2dsZVRoZW1lIH0gZnJvbSBcIi4vdG9nZ2xlVGhlbWVcIjtcbmltcG9ydCB7IHJlbmRlclRhc2tzLCBsaXN0TGlzdGVuZXJzIH0gZnJvbSBcIi4vbGlzdC1jcmVhdG9yXCJcbmltcG9ydCB7IGRpc3BsYXlEYXRlIH0gZnJvbSBcIi4vZGF0ZVwiO1xuXG5mdW5jdGlvbiBjcmVhdGVIVE1MRWxlbWVudCh0eXBlLCBpZCwgY2xhc3NlcywgY29udGVudCkge1xuICAgIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHR5cGUpO1xuXG4gICAgaWYoaWQpIGVsZW1lbnQuaWQgPSBpZDtcbiAgICBpZihjbGFzc2VzKSB7XG4gICAgICAgIGNsYXNzZXMuZm9yRWFjaCgobXlDbGFzcykgPT4gZWxlbWVudC5jbGFzc0xpc3QuYWRkKG15Q2xhc3MpKTtcbiAgICB9O1xuICAgIGlmKGNvbnRlbnQpIGVsZW1lbnQudGV4dENvbnRlbnQgPSBjb250ZW50O1xuXG4gICAgcmV0dXJuIGVsZW1lbnQ7XG59O1xuXG5jb25zdCByZW5kZXIgPSAoKSA9PiB7XG4gICAgc2F2ZUFuZFJlbmRlckxpc3QoKTtcbiAgICByZW5kZXJUYXNrcygpO1xufVxuXG5jb25zdCBvbkxvYWQgPSAoKSA9PiB7XG4gICAgdG9nZ2xlVGhlbWUoKTtcbiAgICByZW5kZXIoKTtcbiAgICBjcmVhdGVEaXJMaXN0ZW5lcigpO1xuICAgIGxpc3RMaXN0ZW5lcnMoKTsgXG4gICAgZGlzcGxheURhdGUoKTtcbiAgICB0aW1lO1xufVxuXG5jb25zdCB0aW1lID0gc2V0SW50ZXJ2YWwoZGlzcGxheURhdGUsIDEwMDApO1xuXG5vbkxvYWQoKTtcblxuZXhwb3J0IHtcbiAgICBjcmVhdGVIVE1MRWxlbWVudCwgcmVuZGVyXG59IiwiY29uc3QgdG9nZ2xlVGhlbWUgPSAoKSA9PiB7XG5cbmNvbnN0IHRvZ2dsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5saWdodC1kYXJrLW1vZGUnKTtcbnRvZ2dsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZU1vZGUpO1xuXG5mdW5jdGlvbiB0b2dnbGVNb2RlKCkge1xuICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJyk7XG4gICAgdG9nZ2xlLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScpO1xuXG4gICAgY29uc3QgY3VycmVudFRoZW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmN1cnJlbnQtdGhlbWUnKTtcblxuICAgIGlmKHRvZ2dsZS5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpKSB7IFxuICAgICAgICBjdXJyZW50VGhlbWUudGV4dENvbnRlbnQgPSAnRGFyayBNb2RlJztcbiAgICB9IGVsc2Uge1xuICAgICAgICBjdXJyZW50VGhlbWUudGV4dENvbnRlbnQgPSAnTGlnaHQgTW9kZSc7XG4gICAgfTtcbn1cbn1cblxuZXhwb3J0IHsgdG9nZ2xlVGhlbWUgfSJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiZXhwb3J0cyIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImRpc3BsYXlEYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwidGV4dENvbnRlbnQiLCJmb3JtYXRBTVBNIiwiZCIsIkRhdGUiLCJtaW51dGVzIiwiZ2V0TWludXRlcyIsInRvU3RyaW5nIiwibGVuZ3RoIiwiaG91cnMiLCJnZXRIb3VycyIsImFtcG0iLCJnZXREYXkiLCJnZXRNb250aCIsImdldERhdGUiLCJnZXRGdWxsWWVhciIsImZvbGRlckRpc3BsYXlDb250YWluZXIiLCJmb2xkZXJUaXRsZSIsInRhc2tDb3VudCIsInRhc2tDb250YWluZXIiLCJ0YXNrVGVtcGxhdGUiLCJyZW5kZXJUYXNrTnVtIiwic2VsZWN0ZWRUYXNrTnVtIiwiaW5jb21wbGV0ZSIsInRhc2tzIiwiZmlsdGVyIiwidGFzayIsImNvbXBsZXRlIiwidGFza3NTdHJpbmciLCJyZW5kZXJUYXNrcyIsInNlbGVjdGVkTGlzdCIsImRpcmVjdG9yeUFyciIsImZpbmQiLCJsaXN0IiwiaWQiLCJzZWxlY3RlZEZvbGRlciIsInN0eWxlIiwiZGlzcGxheSIsIm5hbWUiLCJjbGVhckxpc3QiLCJmb3JFYWNoIiwidGFza0RPTSIsImltcG9ydE5vZGUiLCJjb250ZW50IiwiY2hlY2tCb3giLCJjaGVja2VkIiwidGFza0Rlc2MiLCJkZXNjIiwidGFza0RhdGUiLCJkYXRlIiwicG9zdGVkIiwiaW5uZXJIVE1MIiwiYXBwZW5kQ2hpbGQiLCJjcmVhdGVUYXNrIiwibm93IiwiTE9DQUxfU1RPUkFHRV9ESVJfS0VZIiwiTE9DQUxfU1RPUkFHRV9GT0xERVJfS0VZIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsIkpTT04iLCJwYXJzZSIsInNhdmVBbmRSZW5kZXJMaXN0Iiwic2F2ZSIsInJlbmRlckxpc3RzIiwic2V0SXRlbSIsInN0cmluZ2lmeSIsImRpcmVjdG9yeUNvbnRhaW5lciIsImRpcmVjdG9yeSIsImRpcmVjdG9yeUZvbGRlciIsImNyZWF0ZUhUTUxFbGVtZW50IiwiZGF0YXNldCIsImxpc3RJZCIsImNsYXNzTGlzdCIsImFkZCIsImRpcmVjdG9yeUZvbGRlckljb25zIiwiY29udGFpbnMiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJjcmVhdGVEaXJlY3RvcnkiLCJlIiwiZGlyVGV4dCIsInByZXZlbnREZWZhdWx0IiwiZGlyTmFtZSIsInZhbHVlIiwiY3JlYXRlTmV3RGlyIiwicHVzaCIsInNlbGVjdGVkRGlyZWN0b3J5TGlzdGVuZXIiLCJ0YXJnZXQiLCJ0YWdOYW1lIiwidG9Mb3dlckNhc2UiLCJkZWxldGVEaXIiLCJwYXJlbnRFbGVtZW50IiwicmVuZGVyIiwiZWRpdERpciIsImRpcmVjdG9yeU1vZGFsIiwidG9nZ2xlIiwiZWRpdERpckJ0biIsImNsb3NlRWRpdERpckJ0biIsImVkaXREaXJGb3JtIiwiZGlyZWN0b3J5TW9kYWxUZXh0IiwiZGlyZWN0b3J5UmVOYW1lIiwiZGlyIiwicmVtb3ZlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImNsb3NlRWRpdERpciIsImFkZEV2ZW50TGlzdGVuZXIiLCJ0eXBlIiwiY2xhc3NlcyIsImVsZW1lbnQiLCJjcmVhdGVFbGVtZW50IiwibXlDbGFzcyIsInNldEludGVydmFsIiwiYm9keSIsImN1cnJlbnRUaGVtZSIsInRvZ2dsZVRoZW1lIiwiZGlyRm9ybSIsImRpckNvbnRhaW5lciIsImNyZWF0ZURpckxpc3RlbmVyIiwibGlzdE1vZGFsIiwidGFza0lucHV0TmFtZSIsInRhc2tJbnB1dERlc2MiLCJ0YXNrSW5wdXREYXRlIiwidGFza1Bvc3RlZCIsInRhc2tOYW1lIiwic2VsZWN0ZWRFbGVtZW50IiwicGFyZW50Tm9kZSIsInNlbGVjdGVkVGFzayIsIkFycmF5IiwiZnJvbSIsImNoaWxkcmVuIiwiaW5kZXhPZiIsIml0ZW1zIiwidGFza0VkaXRNb2RhbCIsInRhc2tFZGl0Rm9ybSIsInN1Ym1pdFRhc2tFZGl0IiwiY29uc29sZSIsImxvZyIsImNsb3NlRWRpdFRhc2siLCJjbG9zZUVkaXRUYXNrTW9kYWwiXSwic291cmNlUm9vdCI6IiJ9