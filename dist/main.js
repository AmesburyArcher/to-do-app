(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(){const e=new Date;let t=1==e.getMinutes().toString().length?"0"+e.getMinutes():e.getMinutes(),n=1==e.getHours().toString().length?"0"+e.getHours():e.getHours(),o=e.getHours()>=12?"pm":"am";return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e.getDay()]+" "+["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()]+" "+e.getDate()+" "+e.getFullYear()+" "+n+":"+t+o}e.d({},{N:()=>x,s:()=>E});const n=document.querySelector("#to-do-list"),o=document.querySelector(".to-do-title"),r=document.querySelector(".task-count"),s=document.querySelector(".tasks"),a=document.querySelector("#task-template"),c=e=>{const t=e.tasks.filter((e=>!e.complete)).length,n=1===t?"task":"tasks";r.textContent=`${t} ${n} remaining`},l=()=>{const e=v.find((e=>e.id===m));null==e?n.style.display="none":(n.style.display="",o.textContent=e.name,c(e),k(s),e.tasks.forEach((e=>{const t=document.importNode(a.content,!0),n=t.querySelector("input");n.id=e.id,n.checked=e.complete,t.querySelector(".task-name").textContent=e.name;const o=t.querySelector(".task-desc");e.desc?o.textContent=` Description: ${e.desc}`:o.textContent="No Description.";const r=t.querySelector(".task-date");e.date?r.textContent=` Complete by: ${e.date}`:r.textContent="No Completion Date.",t.querySelector(".task-posted").textContent=`Posted on: ${e.posted}`,t.querySelector(".edit-task").innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="edit-task-icon" width="20" height="20" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" /><line x1="13.5" y1="6.5" x2="17.5" y2="10.5" /></svg>',s.appendChild(t)})))},i=(e,t,n,o)=>({id:Date.now().toString(),name:e,desc:t,date:n,posted:o,complete:!1}),d="task.list",u="task.selectedFolder";let m=localStorage.getItem(u),v=JSON.parse(localStorage.getItem(d))||[];const y=()=>{g(),p()},g=()=>{localStorage.setItem(d,JSON.stringify(v)),localStorage.setItem(u,m)},p=()=>{const e=document.querySelector(".directory");k(e),v.forEach((t=>{const n=x("li",null,["directory-folder"],t.name);n.dataset.listId=t.id,t.id===m&&n.classList.add("directory-active"),e.appendChild(n);const o=x("span",null,["directory-folder-icons"],null);o.innerHTML='<button class="button-edit"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-edit" width="18" height="18" viewBox="0 0 24 24" stroke-width="1.5" stroke="#ffffff" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" /><line x1="13.5" y1="6.5" x2="17.5" y2="10.5" /></svg></button><button class="button-trash"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-trash" width="18" height="18" viewBox="0 0 24 24" stroke-width="1.5" stroke="#ffffff" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="4" y1="7" x2="20" y2="7" /><line x1="10" y1="11" x2="10" y2="17" /><line x1="14" y1="11" x2="14" y2="17" /><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" /><path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" /></svg></button>',n.classList.contains("directory-active")&&n.appendChild(o)}))},k=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)},h=e=>{const t=document.querySelector(".add-dir-btn-text");e.preventDefault();const n=t.value;if(null==n||""===n)return;const o=q(n);t.value=null,v.push(o),y()},f=e=>{"li"===e.target.tagName.toLowerCase()&&(m=e.target.dataset.listId,y(),l())},S=e=>{e.target.classList.contains("icon-trash")&&e.target.parentElement.parentElement.parentElement.dataset.listId===m&&(v=v.filter((e=>e.id!==m)),m=null,E())},L=e=>{if(e.target.classList.contains("icon-edit")&&e.target.parentElement.parentElement.parentElement.dataset.listId===m){const e=document.querySelector(".directory-modal-container");e.classList.toggle("active");const t=document.querySelector("#directory-edit-form"),n=document.querySelector(".icon-tabler-square-x"),o=n=>{n.preventDefault();const r=document.querySelector("#text-dir"),s=r.value;null!=s&&""!==s&&(v.forEach((e=>{e.id===m&&(e.name=s)})),r.value=null,y(),l(),e.classList.remove("active"),t.removeEventListener("submit",o))},r=()=>{e.classList.remove("active"),t.removeEventListener("submit",o),n.removeEventListener("click",r)};n.addEventListener("click",r),t.addEventListener("submit",o)}},q=e=>({id:Date.now().toString(),name:e,tasks:[]});function x(e,t,n,o){const r=document.createElement(e);return t&&(r.id=t),n&&n.forEach((e=>r.classList.add(e))),o&&(r.textContent=o),r}const E=()=>{y(),l()};(()=>{const e=document.querySelector(".light-dark-mode");e.addEventListener("click",(function(){document.body.classList.toggle("active"),e.classList.toggle("active");const t=document.querySelector(".current-theme");e.classList.contains("active")?t.textContent="Dark Mode":t.textContent="Light Mode"}))})(),E(),(()=>{const e=document.querySelector("#add-dir-form"),t=document.querySelector(".directory");e.addEventListener("submit",h),t.addEventListener("click",f),t.addEventListener("click",S),t.addEventListener("click",L)})(),document.querySelector(".create-task-btn").addEventListener("click",(()=>{document.querySelector(".modal-container").classList.add("active")})),document.querySelector("#add-task").addEventListener("submit",(e=>{e.preventDefault();const n=document.querySelector(".modal-container"),o=document.querySelector("#task"),r=document.querySelector("#description"),s=document.querySelector("#date"),a=t(),c=o.value;if(null==c||""===c)return;const l=r.value,d=s.value,u=i(c,l,d,a);o.value=null,r.value=null,s.value=null,v.find((e=>e.id===m)).tasks.push(u),n.classList.remove("active"),E()})),s.addEventListener("click",(e=>{if("input"===e.target.tagName.toLowerCase()){const t=v.find((e=>e.id===m));t.tasks.find((t=>t.id===e.target.id)).complete=e.target.checked,g(),c(t)}})),s.addEventListener("click",(e=>{const t=v.find((e=>e.id===m)),n=e.target.parentNode.parentNode,o=Array.from(n.parentNode.children).indexOf(n),r=document.querySelector(".task-edit"),s=document.querySelector(".description-edit"),a=document.querySelector(".date-edit");let c=t.tasks[o];const i=document.querySelector(".modal-container-edit"),d=document.querySelector("#add-task-edit");if(e.target.classList.contains("edit-task-icon")){r.value=c.name,c.desc?s.value=c.desc:s.value="",c.date?a.value=c.date:a.value="",i.classList.add("active");const e=t=>{console.log(o),t.preventDefault(),c.name=r.value,c.desc=s.value,c.date=a.value,c="",console.log(c),i.classList.remove("active"),d.removeEventListener("submit",e),l(),g()};d.addEventListener("submit",e)}})),document.querySelector(".delete-tasks").addEventListener("click",(()=>{const e=v.find((e=>e.id===m));e.tasks=e.tasks.filter((e=>!e.complete)),E()})),document.querySelector(".close-task-modal").addEventListener("click",(()=>{document.querySelector(".modal-container").classList.remove("active")})),document.querySelector(".current-date").textContent=t()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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K0MsRUFBTW5GLEtBQU93RSxFQUFjcEMsTUFBUSxHQUN0RStDLEVBQU1qRixLQUFPdUUsRUFBY3JDLE1BQVErQyxFQUFNakYsS0FBT3VFLEVBQWNyQyxNQUFRLEdBRXRFZ0QsRUFBYzNELFVBQVVDLElBQUksVUFFL0IsTUFBTTRELEVBQWtCdEQsSUFDcEJ1RCxRQUFRQyxJQUFJVixHQUNaOUMsRUFBRUUsaUJBQ0ZpRCxFQUFNNUYsS0FBT2dGLEVBQWNuQyxNQUMzQitDLEVBQU1uRixLQUFPd0UsRUFBY3BDLE1BQzNCK0MsRUFBTWpGLEtBQU91RSxFQUFjckMsTUFDM0IrQyxFQUFRLEdBQ1JJLFFBQVFDLElBQUlMLEdBQ1pDLEVBQWMzRCxVQUFVOEIsT0FBTyxVQUMvQjhCLEVBQWE3QixvQkFBb0IsU0FBVThCLEdBQzNDeEcsSUFDQWlDLEtBR0RzRSxFQUFhM0IsaUJBQWlCLFNBQVU0QixPQS9GdkJ2SCxTQUFTQyxjQUFjLGlCQUMvQjBGLGlCQUFpQixTQVFMLEtBQ3hCLE1BQU0zRSxFQUFlQyxFQUFhQyxNQUFLQyxHQUFRQSxFQUFLQyxLQUFPQyxJQUMzREwsRUFBYVAsTUFBUU8sRUFBYVAsTUFBTUMsUUFBT0MsSUFBU0EsRUFBS0MsV0FDN0RrRSxPQVRrQjlFLFNBQVNDLGNBQWMscUJBQy9CMEYsaUJBQWlCLFNBZ0hSLEtBQ0QzRixTQUFTQyxjQUFjLG9CQUMvQnlELFVBQVU4QixPQUFPLGFEOUlYeEYsU0FBU0MsY0FBYyxpQkFDL0JhLFlBQWM3QixLIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG8tZG8tYXBwL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3RvLWRvLWFwcC93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vdG8tZG8tYXBwL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vdG8tZG8tYXBwLy4vc3JjL2RhdGUuanMiLCJ3ZWJwYWNrOi8vdG8tZG8tYXBwLy4vc3JjL2xpc3QtY3JlYXRvci5qcyIsIndlYnBhY2s6Ly90by1kby1hcHAvLi9zcmMvZGlyZWN0b3J5LWNyZWF0b3IuanMiLCJ3ZWJwYWNrOi8vdG8tZG8tYXBwLy4vc3JjL2luZGV4LmpzIiwid2VicGFjazovL3RvLWRvLWFwcC8uL3NyYy90b2dnbGVUaGVtZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsImNvbnN0IGRpc3BsYXlEYXRlID0gKCkgPT4ge1xuICAgIGNvbnN0IGRhdGVET00gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY3VycmVudC1kYXRlJyk7XG4gICAgZGF0ZURPTS50ZXh0Q29udGVudCA9IGZvcm1hdEFNUE0oKVxufVxuXG5mdW5jdGlvbiBmb3JtYXRBTVBNKCkge1xuICAgIGNvbnN0IGQgPSBuZXcgRGF0ZSgpXG4gICAgbGV0IG1pbnV0ZXMgPSBkLmdldE1pbnV0ZXMoKS50b1N0cmluZygpLmxlbmd0aCA9PSAxID8gJzAnK2QuZ2V0TWludXRlcygpIDogZC5nZXRNaW51dGVzKCk7XG4gICAgbGV0IGhvdXJzID0gZC5nZXRIb3VycygpLnRvU3RyaW5nKCkubGVuZ3RoID09IDEgPyAnMCcrZC5nZXRIb3VycygpIDogZC5nZXRIb3VycygpO1xuICAgIGxldCBhbXBtID0gZC5nZXRIb3VycygpID49IDEyID8gJ3BtJyA6ICdhbSc7XG4gICAgbGV0IG1vbnRocyA9IFsnSmFuJywnRmViJywnTWFyJywnQXByJywnTWF5JywnSnVuJywnSnVsJywnQXVnJywnU2VwJywnT2N0JywnTm92JywnRGVjJ107XG4gICAgbGV0IGRheXMgPSBbJ1N1bicsJ01vbicsJ1R1ZScsJ1dlZCcsJ1RodScsJ0ZyaScsJ1NhdCddO1xuICAgIHJldHVybiBkYXlzW2QuZ2V0RGF5KCldKycgJyttb250aHNbZC5nZXRNb250aCgpXSsnICcrZC5nZXREYXRlKCkrJyAnK2QuZ2V0RnVsbFllYXIoKSsnICcraG91cnMrJzonK21pbnV0ZXMrYW1wbTtcbiAgICB9XG5cbmV4cG9ydCB7IGRpc3BsYXlEYXRlLCBmb3JtYXRBTVBNIH0iLCJpbXBvcnQgeyBjcmVhdGVIVE1MRWxlbWVudCwgcmVuZGVyIH0gZnJvbSBcIi4vaW5kZXhcIjtcbmltcG9ydCB7IHJlbmRlckxpc3RzLCBjcmVhdGVEaXJMaXN0ZW5lciwgc2F2ZUFuZFJlbmRlckxpc3QsIGRpcmVjdG9yeUFyciwgc2VsZWN0ZWRGb2xkZXIsIGNsZWFyTGlzdCwgc2F2ZSB9IGZyb20gXCIuL2RpcmVjdG9yeS1jcmVhdG9yXCI7XG5pbXBvcnQgeyBmb3JtYXRBTVBNIH0gZnJvbSBcIi4vZGF0ZVwiO1xuXG5cbmNvbnN0IGZvbGRlckRpc3BsYXlDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdG8tZG8tbGlzdCcpO1xuY29uc3QgZm9sZGVyVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudG8tZG8tdGl0bGUnKTtcbmNvbnN0IHRhc2tDb3VudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50YXNrLWNvdW50Jyk7XG5jb25zdCB0YXNrQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRhc2tzJyk7XG5jb25zdCB0YXNrVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdGFzay10ZW1wbGF0ZScpO1xuXG4vLyBjcmVhdGVzIGxpc3RlbmVycyBmb3IgdGFza3NcbmNvbnN0IGxpc3RMaXN0ZW5lcnMgPSAoKSA9PiB7XG4gICAgY29uc3QgY3JlYXRlVGFza0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jcmVhdGUtdGFzay1idG4nKTtcbiAgICBjcmVhdGVUYXNrQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY3JlYXRlVGFza01vZGFsKVxuXG4gICAgY29uc3Qgc3VibWl0VGFzayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhZGQtdGFzaycpO1xuICAgIHN1Ym1pdFRhc2suYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0Jywgc3VibWl0Rm9ybSk7XG5cbiAgICAvL2NoZWNrIGlmIGNvbXBsZXRlXG4gICAgdGFza0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRhc2tDaGVjayk7XG5cbiAgICAvL2VkaXQgdGFza1xuICAgIHRhc2tDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlZGl0VGFza0RldGFpbHMpO1xuXG4gICAgY29uc3QgZGVsZXRlVGFza3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZGVsZXRlLXRhc2tzJyk7XG4gICAgZGVsZXRlVGFza3MuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBkZWxldGVTZWxlY3RlZFRhc2tzKVxuXG4gICAgY29uc3QgY2xvc2VUYXNrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNsb3NlLXRhc2stbW9kYWwnKTtcbiAgICBjbG9zZVRhc2suYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZVRhc2tNb2RhbCk7XG4gICAgXG59XG5cbi8vIGRlbGV0ZXMgc2VsZWN0ZWQgdGFza3NcbmNvbnN0IGRlbGV0ZVNlbGVjdGVkVGFza3MgPSAoKSA9PiB7XG4gICAgY29uc3Qgc2VsZWN0ZWRMaXN0ID0gZGlyZWN0b3J5QXJyLmZpbmQobGlzdCA9PiBsaXN0LmlkID09PSBzZWxlY3RlZEZvbGRlcik7XG4gICAgc2VsZWN0ZWRMaXN0LnRhc2tzID0gc2VsZWN0ZWRMaXN0LnRhc2tzLmZpbHRlcih0YXNrID0+ICF0YXNrLmNvbXBsZXRlKTtcbiAgICByZW5kZXIoKTtcbn1cblxuLy8gY2hlY2tzIGlmIHRhc2sgaXMgbWFya2VkIGNvbXBsZXRlXG5jb25zdCB0YXNrQ2hlY2sgPSAoZSkgPT4ge1xuICAgIGlmKGUudGFyZ2V0LnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2lucHV0Jykge1xuICAgICAgICBjb25zdCBzZWxlY3RlZExpc3QgPSBkaXJlY3RvcnlBcnIuZmluZChsaXN0ID0+IGxpc3QuaWQgPT09IHNlbGVjdGVkRm9sZGVyKTtcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRUYXNrID0gc2VsZWN0ZWRMaXN0LnRhc2tzLmZpbmQodGFzayA9PiB0YXNrLmlkID09PSBlLnRhcmdldC5pZCkgXG4gICAgICAgIHNlbGVjdGVkVGFzay5jb21wbGV0ZSA9IGUudGFyZ2V0LmNoZWNrZWQ7XG4gICAgICAgIHNhdmUoKTtcbiAgICAgICAgcmVuZGVyVGFza051bShzZWxlY3RlZExpc3QpO1xuICAgIH1cbn1cblxuLy8gcmVuZGVycyBhbmQgZGlzcGxheXMgdG8gRE9NIG51bWJlciBvZiB0YXNrcyByZW1haW5pbmcgdG8gY29tcGxldGVcbmNvbnN0IHJlbmRlclRhc2tOdW0gPSAoc2VsZWN0ZWRUYXNrTnVtKSA9PiB7XG4gICAgY29uc3QgaW5jb21wbGV0ZSA9IHNlbGVjdGVkVGFza051bS50YXNrcy5maWx0ZXIodGFzayA9PiAhdGFzay5jb21wbGV0ZSkubGVuZ3RoO1xuICAgIGNvbnN0IHRhc2tzU3RyaW5nID0gaW5jb21wbGV0ZSA9PT0gMSA/IFwidGFza1wiIDogXCJ0YXNrc1wiO1xuICAgIHRhc2tDb3VudC50ZXh0Q29udGVudCA9IGAke2luY29tcGxldGV9ICR7dGFza3NTdHJpbmd9IHJlbWFpbmluZ2A7XG59XG5cbi8vIGZ1bmN0aW9uIHVzZWQgdG8gY3JlYXRlIHRoZSB0YXNrIGVsZW1lbnQgZm9yIHRoZSBET01cbmNvbnN0IHJlbmRlclRhc2tMaXN0ID0gKHNlbGVjdGVkVGFza0xpc3QpID0+IHtcbiAgICBzZWxlY3RlZFRhc2tMaXN0LnRhc2tzLmZvckVhY2godGFzayA9PiB7XG4gICAgICAgIGNvbnN0IHRhc2tET00gPSBkb2N1bWVudC5pbXBvcnROb2RlKHRhc2tUZW1wbGF0ZS5jb250ZW50LCB0cnVlKVxuICAgICAgICBjb25zdCBjaGVja0JveCA9IHRhc2tET00ucXVlcnlTZWxlY3RvcignaW5wdXQnKTtcbiAgICAgICAgY2hlY2tCb3guaWQgPSB0YXNrLmlkO1xuICAgICAgICBjaGVja0JveC5jaGVja2VkID0gdGFzay5jb21wbGV0ZTtcbiAgICAgICAgY29uc3QgdGFza05hbWUgPSAgdGFza0RPTS5xdWVyeVNlbGVjdG9yKCcudGFzay1uYW1lJyk7XG4gICAgICAgIHRhc2tOYW1lLnRleHRDb250ZW50ID0gdGFzay5uYW1lO1xuXG4gICAgICAgIGNvbnN0IHRhc2tEZXNjID0gdGFza0RPTS5xdWVyeVNlbGVjdG9yKCcudGFzay1kZXNjJylcbiAgICAgICAgdGFzay5kZXNjID8gdGFza0Rlc2MudGV4dENvbnRlbnQgPSBgIERlc2NyaXB0aW9uOiAke3Rhc2suZGVzY31gIDogdGFza0Rlc2MudGV4dENvbnRlbnQgPSAnTm8gRGVzY3JpcHRpb24uJztcbiAgICAgICBcbiAgICAgICAgY29uc3QgdGFza0RhdGUgPSB0YXNrRE9NLnF1ZXJ5U2VsZWN0b3IoJy50YXNrLWRhdGUnKTtcbiAgICAgICAgdGFzay5kYXRlID8gdGFza0RhdGUudGV4dENvbnRlbnQgPSBgIENvbXBsZXRlIGJ5OiAke3Rhc2suZGF0ZX1gIDogdGFza0RhdGUudGV4dENvbnRlbnQgPSAnTm8gQ29tcGxldGlvbiBEYXRlLic7XG5cbiAgICAgICAgY29uc3QgdGFza1Bvc3RlZCA9IHRhc2tET00ucXVlcnlTZWxlY3RvcignLnRhc2stcG9zdGVkJyk7XG4gICAgICAgIHRhc2tQb3N0ZWQudGV4dENvbnRlbnQgPSBgUG9zdGVkIG9uOiAke3Rhc2sucG9zdGVkfWA7XG5cbiAgICAgICAgY29uc3QgZWRpdFRhc2sgPSB0YXNrRE9NLnF1ZXJ5U2VsZWN0b3IoJy5lZGl0LXRhc2snKTtcbiAgICAgICAgZWRpdFRhc2suaW5uZXJIVE1MID0gJzxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIGNsYXNzPVwiZWRpdC10YXNrLWljb25cIiB3aWR0aD1cIjIwXCIgaGVpZ2h0PVwiMjBcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgc3Ryb2tlLXdpZHRoPVwiMS41XCIgc3Ryb2tlPVwiIzAwMDAwMFwiIGZpbGw9XCJub25lXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+PHBhdGggc3Ryb2tlPVwibm9uZVwiIGQ9XCJNMCAwaDI0djI0SDB6XCIgZmlsbD1cIm5vbmVcIi8+PHBhdGggZD1cIk00IDIwaDRsMTAuNSAtMTAuNWExLjUgMS41IDAgMCAwIC00IC00bC0xMC41IDEwLjV2NFwiIC8+PGxpbmUgeDE9XCIxMy41XCIgeTE9XCI2LjVcIiB4Mj1cIjE3LjVcIiB5Mj1cIjEwLjVcIiAvPjwvc3ZnPidcblxuICAgICAgICB0YXNrQ29udGFpbmVyLmFwcGVuZENoaWxkKHRhc2tET00pO1xuICAgIH0pXG4gICAgXG59XG5cbmNvbnN0IGVkaXRUYXNrRGV0YWlscyA9IChlKSA9PiB7XG5cbiAgICBjb25zdCBzZWxlY3RlZExpc3QgPSBkaXJlY3RvcnlBcnIuZmluZChsaXN0ID0+IGxpc3QuaWQgPT09IHNlbGVjdGVkRm9sZGVyKTsgXG4gICAgY29uc3Qgc2VsZWN0ZWRFbGVtZW50ID0gZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlO1xuICAgIGNvbnN0IHNlbGVjdGVkVGFzayA9IEFycmF5LmZyb20oc2VsZWN0ZWRFbGVtZW50LnBhcmVudE5vZGUuY2hpbGRyZW4pLmluZGV4T2Yoc2VsZWN0ZWRFbGVtZW50KVxuXG4gICAgY29uc3QgdGFza0lucHV0TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50YXNrLWVkaXQnKTtcbiAgICBjb25zdCB0YXNrSW5wdXREZXNjID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uLWVkaXQnKTtcbiAgICBjb25zdCB0YXNrSW5wdXREYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRhdGUtZWRpdCcpO1xuXG4gICAgbGV0IGl0ZW1zID0gc2VsZWN0ZWRMaXN0LnRhc2tzW3NlbGVjdGVkVGFza107XG4gICAgY29uc3QgdGFza0VkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1jb250YWluZXItZWRpdCcpO1xuICAgIGNvbnN0IHRhc2tFZGl0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhZGQtdGFzay1lZGl0Jyk7XG5cbiAgICBpZihlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2VkaXQtdGFzay1pY29uJykpIHtcbiAgICAgICB0YXNrSW5wdXROYW1lLnZhbHVlID0gaXRlbXMubmFtZTtcbiAgICAgICBpdGVtcy5kZXNjID8gdGFza0lucHV0RGVzYy52YWx1ZSA9IGl0ZW1zLmRlc2MgOiB0YXNrSW5wdXREZXNjLnZhbHVlID0gJyc7XG4gICAgICAgaXRlbXMuZGF0ZSA/IHRhc2tJbnB1dERhdGUudmFsdWUgPSBpdGVtcy5kYXRlIDogdGFza0lucHV0RGF0ZS52YWx1ZSA9ICcnO1xuICAgICAgIFxuICAgICAgIHRhc2tFZGl0TW9kYWwuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gICAgICAgXG4gICAgY29uc3Qgc3VibWl0VGFza0VkaXQgPSAoZSkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhzZWxlY3RlZFRhc2spXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgaXRlbXMubmFtZSA9IHRhc2tJbnB1dE5hbWUudmFsdWU7XG4gICAgICAgIGl0ZW1zLmRlc2MgPSB0YXNrSW5wdXREZXNjLnZhbHVlO1xuICAgICAgICBpdGVtcy5kYXRlID0gdGFza0lucHV0RGF0ZS52YWx1ZTtcbiAgICAgICAgaXRlbXMgPSAnJztcbiAgICAgICAgY29uc29sZS5sb2coaXRlbXMpO1xuICAgICAgICB0YXNrRWRpdE1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgICAgICB0YXNrRWRpdEZvcm0ucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3VibWl0Jywgc3VibWl0VGFza0VkaXQpO1xuICAgICAgICByZW5kZXJUYXNrcygpO1xuICAgICAgICBzYXZlKCk7XG4gICAgfVxuXG4gICAgICAgdGFza0VkaXRGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHN1Ym1pdFRhc2tFZGl0KVxuICAgIH1cblxufVxuXG4vLyByZW5kZXJzIHRoZSB0YXNrcyBmcm9tIHRoZSBzZWxlY3RlZCBmb2xkZXIgb24gdGhlIHNjcmVlblxuY29uc3QgcmVuZGVyVGFza3MgPSAoKSA9PiB7XG4gICAgY29uc3Qgc2VsZWN0ZWRMaXN0ID0gZGlyZWN0b3J5QXJyLmZpbmQobGlzdCA9PiBsaXN0LmlkID09PSBzZWxlY3RlZEZvbGRlcik7XG5cbiAgICBpZihzZWxlY3RlZExpc3QgPT0gbnVsbCkge1xuICAgICAgICBmb2xkZXJEaXNwbGF5Q29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZm9sZGVyRGlzcGxheUNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJyc7XG4gICAgICAgIGZvbGRlclRpdGxlLnRleHRDb250ZW50ID0gc2VsZWN0ZWRMaXN0Lm5hbWU7XG4gICAgICAgIHJlbmRlclRhc2tOdW0oc2VsZWN0ZWRMaXN0KTtcbiAgICAgICAgY2xlYXJMaXN0KHRhc2tDb250YWluZXIpO1xuICAgICAgICByZW5kZXJUYXNrTGlzdChzZWxlY3RlZExpc3QpO1xuICAgIH1cbn1cblxuLy8gY2xvc2VzIHRoZSB0YXNrIG1vZGFsIHdpdGggY2xpY2sgb2YgYnV0dG9uXG5jb25zdCBjbG9zZVRhc2tNb2RhbCA9ICgpID0+IHtcbiAgICBjb25zdCBsaXN0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtY29udGFpbmVyJylcbiAgICBsaXN0TW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG59XG5cbi8vIGZ1bmN0aW9uIHRoYXQgZGlzcGxheXMgbW9kYWwgdG8gYWRkIG5ldyB0YXNrXG5jb25zdCBjcmVhdGVUYXNrTW9kYWwgPSAoKSA9PiB7XG4gICAgY29uc3QgbGlzdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWNvbnRhaW5lcicpXG4gICAgbGlzdE1vZGFsLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xufVxuXG4vLyBmdW5jdGlvbiB0aGF0IHByb2Nlc3NlcyB0aGUgaW5wdXQgZnJvbSB0aGUgY3JlYXRlIHRhc2sgbW9kYWwgYW5kIHN1Ym1pdHMgaXQgZm9yIHN0b3JhZ2UgYW5kIGRpc3BsYXlcbmNvbnN0IHN1Ym1pdEZvcm0gPSAoZSkgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCBsaXN0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtY29udGFpbmVyJylcbiAgICBjb25zdCB0YXNrSW5wdXROYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Rhc2snKTtcbiAgICBjb25zdCB0YXNrSW5wdXREZXNjID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2Rlc2NyaXB0aW9uJyk7XG4gICAgY29uc3QgdGFza0lucHV0RGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNkYXRlJyk7XG4gICAgY29uc3QgdGFza1Bvc3RlZCA9IGZvcm1hdEFNUE0oKTtcbiAgICBcbiAgICBjb25zdCB0YXNrTmFtZSA9IHRhc2tJbnB1dE5hbWUudmFsdWU7XG4gICAgaWYodGFza05hbWUgPT0gbnVsbCB8fCB0YXNrTmFtZSA9PT0gJycpIHJldHVybjtcbiAgICBjb25zdCB0YXNrRGVzYyA9IHRhc2tJbnB1dERlc2MudmFsdWU7XG4gICAgY29uc3QgdGFza0RhdGUgPSB0YXNrSW5wdXREYXRlLnZhbHVlXG4gICAgY29uc3QgdGFzayA9IGNyZWF0ZVRhc2sodGFza05hbWUsIHRhc2tEZXNjLCB0YXNrRGF0ZSwgdGFza1Bvc3RlZCk7XG4gICAgdGFza0lucHV0TmFtZS52YWx1ZSA9IG51bGw7XG4gICAgdGFza0lucHV0RGVzYy52YWx1ZSA9IG51bGw7XG4gICAgdGFza0lucHV0RGF0ZS52YWx1ZSA9IG51bGw7XG4gICAgY29uc3Qgc2VsZWN0ZWRMaXN0ID0gZGlyZWN0b3J5QXJyLmZpbmQobGlzdCA9PiBsaXN0LmlkID09PSBzZWxlY3RlZEZvbGRlcik7XG4gICAgc2VsZWN0ZWRMaXN0LnRhc2tzLnB1c2godGFzayk7XG4gICAgbGlzdE1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgIHJlbmRlcigpO1xufVxuXG4vLyB0aGlzIGZ1bmN0aW9uIGNyZWF0ZXMgdGhlIHRhc2sgb2JqZWN0IHRvIGJlIHB1c2hlZCBpbnRvIHRoZSBkaXJlY3RvcnlBcnIudGFza3MgYXJyYXlcbmNvbnN0IGNyZWF0ZVRhc2sgPSAodGFzaywgZGVzYywgZGF0ZSwgcG9zdGVkKSA9PiB7XG4gICAgcmV0dXJuIHsgIGlkOiBEYXRlLm5vdygpLnRvU3RyaW5nKCksIG5hbWU6IHRhc2ssIGRlc2M6IGRlc2MsIGRhdGU6IGRhdGUsIHBvc3RlZDogcG9zdGVkLCBjb21wbGV0ZTogZmFsc2UsICB9XG59XG5cblxuZXhwb3J0IHsgcmVuZGVyVGFza3MsIGxpc3RMaXN0ZW5lcnMgfSIsImltcG9ydCB7IGNyZWF0ZUhUTUxFbGVtZW50LCByZW5kZXIgfSBmcm9tIFwiLi9pbmRleFwiO1xuaW1wb3J0IHsgcmVuZGVyVGFza3MgfSBmcm9tIFwiLi9saXN0LWNyZWF0b3JcIjtcblxuY29uc3QgTE9DQUxfU1RPUkFHRV9ESVJfS0VZID0gJ3Rhc2subGlzdCc7XG5jb25zdCBMT0NBTF9TVE9SQUdFX0ZPTERFUl9LRVkgPSAndGFzay5zZWxlY3RlZEZvbGRlcic7XG5cbi8vbG9jYWwgc3RvcmFnZSBrZXlzICsgYXJyYXlcbmxldCBzZWxlY3RlZEZvbGRlciA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKExPQ0FMX1NUT1JBR0VfRk9MREVSX0tFWSlcbmxldCBkaXJlY3RvcnlBcnIgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKExPQ0FMX1NUT1JBR0VfRElSX0tFWSkpIHx8IFtdOyBcblxuY29uc3Qgc2F2ZUFuZFJlbmRlckxpc3QgPSAoKSA9PiB7XG4gICAgc2F2ZSgpO1xuICAgIHJlbmRlckxpc3RzKCk7XG59XG5cbi8vc2F2ZXMgdG8gbG9jYWwgc3RvcmFnZVxuY29uc3Qgc2F2ZSA9ICgpID0+IHtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShMT0NBTF9TVE9SQUdFX0RJUl9LRVksIEpTT04uc3RyaW5naWZ5KGRpcmVjdG9yeUFycikpO1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKExPQ0FMX1NUT1JBR0VfRk9MREVSX0tFWSwgc2VsZWN0ZWRGb2xkZXIpO1xufVxuXG4vL3JlbmRlcnMgdGhlIGRpcmVjdG9yeSBsaXN0XG5jb25zdCByZW5kZXJMaXN0cyA9ICgpID0+IHtcbiAgICBjb25zdCBkaXJlY3RvcnlDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZGlyZWN0b3J5Jyk7XG5cbiAgICBjbGVhckxpc3QoZGlyZWN0b3J5Q29udGFpbmVyKTtcbiAgICBkaXJlY3RvcnlBcnIuZm9yRWFjaChkaXJlY3RvcnkgPT4ge1xuICAgICAgIGNvbnN0IGRpcmVjdG9yeUZvbGRlciA9IGNyZWF0ZUhUTUxFbGVtZW50KCdsaScsIG51bGwsIFsnZGlyZWN0b3J5LWZvbGRlciddLCBkaXJlY3RvcnkubmFtZSlcbiAgICAgICBkaXJlY3RvcnlGb2xkZXIuZGF0YXNldC5saXN0SWQgPSBkaXJlY3RvcnkuaWQ7XG4gICAgICAgLy9pZiB0aGUgZm9sZGVyIGlzIHNlbGVjdGVkLCBtYWtlIGl0IGFjdGl2ZSBmb2xkZXJcbiAgICAgICBpZihkaXJlY3RvcnkuaWQgPT09IHNlbGVjdGVkRm9sZGVyKSB7XG4gICAgICAgICAgIGRpcmVjdG9yeUZvbGRlci5jbGFzc0xpc3QuYWRkKCdkaXJlY3RvcnktYWN0aXZlJyk7XG4gICAgICAgfTtcbiAgICAgICBkaXJlY3RvcnlDb250YWluZXIuYXBwZW5kQ2hpbGQoZGlyZWN0b3J5Rm9sZGVyKTsgXG5cbiAgICAgICBjb25zdCBkaXJlY3RvcnlGb2xkZXJJY29ucyA9IGNyZWF0ZUhUTUxFbGVtZW50KCdzcGFuJywgbnVsbCwgWydkaXJlY3RvcnktZm9sZGVyLWljb25zJ10sIG51bGwpO1xuICAgICAgIGRpcmVjdG9yeUZvbGRlckljb25zLmlubmVySFRNTCA9ICc8YnV0dG9uIGNsYXNzPVwiYnV0dG9uLWVkaXRcIj48c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBjbGFzcz1cImljb24gaWNvbi1lZGl0XCIgd2lkdGg9XCIxOFwiIGhlaWdodD1cIjE4XCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHN0cm9rZS13aWR0aD1cIjEuNVwiIHN0cm9rZT1cIiNmZmZmZmZcIiBmaWxsPVwibm9uZVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPjxwYXRoIHN0cm9rZT1cIm5vbmVcIiBkPVwiTTAgMGgyNHYyNEgwelwiIGZpbGw9XCJub25lXCIvPjxwYXRoIGQ9XCJNNCAyMGg0bDEwLjUgLTEwLjVhMS41IDEuNSAwIDAgMCAtNCAtNGwtMTAuNSAxMC41djRcIiAvPjxsaW5lIHgxPVwiMTMuNVwiIHkxPVwiNi41XCIgeDI9XCIxNy41XCIgeTI9XCIxMC41XCIgLz48L3N2Zz48L2J1dHRvbj48YnV0dG9uIGNsYXNzPVwiYnV0dG9uLXRyYXNoXCI+PHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgY2xhc3M9XCJpY29uIGljb24tdHJhc2hcIiB3aWR0aD1cIjE4XCIgaGVpZ2h0PVwiMThcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgc3Ryb2tlLXdpZHRoPVwiMS41XCIgc3Ryb2tlPVwiI2ZmZmZmZlwiIGZpbGw9XCJub25lXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+PHBhdGggc3Ryb2tlPVwibm9uZVwiIGQ9XCJNMCAwaDI0djI0SDB6XCIgZmlsbD1cIm5vbmVcIi8+PGxpbmUgeDE9XCI0XCIgeTE9XCI3XCIgeDI9XCIyMFwiIHkyPVwiN1wiIC8+PGxpbmUgeDE9XCIxMFwiIHkxPVwiMTFcIiB4Mj1cIjEwXCIgeTI9XCIxN1wiIC8+PGxpbmUgeDE9XCIxNFwiIHkxPVwiMTFcIiB4Mj1cIjE0XCIgeTI9XCIxN1wiIC8+PHBhdGggZD1cIk01IDdsMSAxMmEyIDIgMCAwIDAgMiAyaDhhMiAyIDAgMCAwIDIgLTJsMSAtMTJcIiAvPjxwYXRoIGQ9XCJNOSA3di0zYTEgMSAwIDAgMSAxIC0xaDRhMSAxIDAgMCAxIDEgMXYzXCIgLz48L3N2Zz48L2J1dHRvbj4nO1xuICAgICAgIC8vaWYgdGhlIGZvbGRlciBpcyBzZWxlY3RlZCwgYWRkIHRoZSBpY29uc1xuICAgICAgIGlmKGRpcmVjdG9yeUZvbGRlci5jbGFzc0xpc3QuY29udGFpbnMoJ2RpcmVjdG9yeS1hY3RpdmUnKSkge1xuICAgICAgIGRpcmVjdG9yeUZvbGRlci5hcHBlbmRDaGlsZChkaXJlY3RvcnlGb2xkZXJJY29ucyk7XG4gICAgICAgfTtcbiAgICB9KVxufTtcblxuLy9jbGVhcnMgdGhlIGRpcmVjdG9yeSBsaXN0IHRvIGJlIHJlLXJlbmRlcmVkIGluIHJlbmRlckxpc3RzXG5jb25zdCBjbGVhckxpc3QgPSAobGlzdCkgPT4ge1xuICAgIHdoaWxlKGxpc3QuZmlyc3RDaGlsZCkge1xuICAgICAgICBsaXN0LnJlbW92ZUNoaWxkKGxpc3QuZmlyc3RDaGlsZClcbiAgICB9XG59O1xuXG4vL2FkZHMgZXZlbnRsaXN0ZW5lcnMgZm9yIHRoZSBkaXJlY3RvcnlcbmNvbnN0IGNyZWF0ZURpckxpc3RlbmVyID0gKCkgPT4ge1xuICAgIGNvbnN0IGRpckZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYWRkLWRpci1mb3JtJyk7XG4gICAgY29uc3QgZGlyQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRpcmVjdG9yeScpO1xuXG4gICAgZGlyRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBjcmVhdGVEaXJlY3RvcnkpXG4gICAgZGlyQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc2VsZWN0ZWREaXJlY3RvcnlMaXN0ZW5lcilcbiAgICBkaXJDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBkZWxldGVEaXIpXG4gICAgZGlyQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZWRpdERpcilcbn1cblxuLy9jcmVhdGVzIGEgbmV3IGRpcmVjdG9yeSBmb2xkZXJcbmNvbnN0IGNyZWF0ZURpcmVjdG9yeSA9IChlKSA9PiB7XG4gICAgY29uc3QgZGlyVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hZGQtZGlyLWJ0bi10ZXh0Jyk7XG5cbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgZGlyTmFtZSA9IGRpclRleHQudmFsdWU7XG4gICAgaWYoZGlyTmFtZSA9PSBudWxsIHx8IGRpck5hbWUgPT09ICcnKSByZXR1cm47XG4gICAgY29uc3QgZGlyZWN0b3J5ID0gY3JlYXRlTmV3RGlyKGRpck5hbWUpO1xuICAgIGRpclRleHQudmFsdWUgPSBudWxsO1xuICAgIGRpcmVjdG9yeUFyci5wdXNoKGRpcmVjdG9yeSk7XG4gICAgc2F2ZUFuZFJlbmRlckxpc3QoKTtcbn1cblxuLy9mdW5jdGlvbiBmb3IgdGhlIHNlbGVjdGVkIGRpcmVjdG9yeSBsaXN0ZW5lclxuY29uc3Qgc2VsZWN0ZWREaXJlY3RvcnlMaXN0ZW5lciA9IChlKSA9PiB7XG4gICAgaWYoZS50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnbGknKSB7XG4gICAgICAgIHNlbGVjdGVkRm9sZGVyID0gZS50YXJnZXQuZGF0YXNldC5saXN0SWQ7XG4gICAgICAgIHNhdmVBbmRSZW5kZXJMaXN0KCk7XG4gICAgICAgIHJlbmRlclRhc2tzKCk7XG4gICAgfVxufVxuXG4vL2Z1bmN0aW9uIGZvciB0aGUgZGVsZXRlZGlyIGxpc3RlbmVyIFxuY29uc3QgZGVsZXRlRGlyID0gKGUpID0+IHtcbiAgICBpZihlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2ljb24tdHJhc2gnKSAmJiBlLnRhcmdldC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5kYXRhc2V0Lmxpc3RJZCA9PT0gc2VsZWN0ZWRGb2xkZXIpIHtcbiAgICAgICAgZGlyZWN0b3J5QXJyID0gZGlyZWN0b3J5QXJyLmZpbHRlcihkaXJlY3RvcnkgPT4gZGlyZWN0b3J5LmlkICE9PSBzZWxlY3RlZEZvbGRlcik7XG4gICAgICAgIHNlbGVjdGVkRm9sZGVyID0gbnVsbDtcbiAgICAgICAgLy8gc2F2ZUFuZFJlbmRlckxpc3QoKTtcbiAgICAgICAgLy8gcmVuZGVyVGFza3MoKTtcbiAgICAgICAgcmVuZGVyKCk7XG4gICAgfVxufVxuLy9FZGl0aW5nIHRoZSBkaXJlY3RvcnkgZm9sZGVyIHRpdGxlIGFuZCB1cGRhdGluZyB0aGUgYXJyYXkgKyBET01cbmNvbnN0IGVkaXREaXIgPSAoZSkgPT4ge1xuICAgIGlmKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnaWNvbi1lZGl0JykgJiYgZS50YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuZGF0YXNldC5saXN0SWQgPT09IHNlbGVjdGVkRm9sZGVyKSB7XG4gICAgICAgIGNvbnN0IGRpcmVjdG9yeU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRpcmVjdG9yeS1tb2RhbC1jb250YWluZXInKTtcbiAgICAgICAgZGlyZWN0b3J5TW9kYWwuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJyk7XG4gICAgICAgIGNvbnN0IGVkaXREaXJCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZGlyZWN0b3J5LWVkaXQtZm9ybScpO1xuICAgICAgICBjb25zdCBjbG9zZUVkaXREaXJCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaWNvbi10YWJsZXItc3F1YXJlLXgnKTtcblxuICAgICAgICBjb25zdCBlZGl0RGlyRm9ybSA9IChlKSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBjb25zdCBkaXJlY3RvcnlNb2RhbFRleHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdGV4dC1kaXInKTtcbiAgICAgICAgICAgIGNvbnN0IGRpcmVjdG9yeVJlTmFtZSA9IGRpcmVjdG9yeU1vZGFsVGV4dC52YWx1ZTtcbiAgICAgICAgICAgIGlmKGRpcmVjdG9yeVJlTmFtZSA9PSBudWxsIHx8IGRpcmVjdG9yeVJlTmFtZSA9PT0gJycpIHJldHVybjtcbiAgICAgICAgICAgIGRpcmVjdG9yeUFyci5mb3JFYWNoKGRpciA9PiB7XG4gICAgICAgICAgICAgICAgaWYoZGlyLmlkID09PSBzZWxlY3RlZEZvbGRlcikge1xuICAgICAgICAgICAgICAgICAgICBkaXIubmFtZSA9IGRpcmVjdG9yeVJlTmFtZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBkaXJlY3RvcnlNb2RhbFRleHQudmFsdWUgPSBudWxsO1xuICAgICAgICAgICAgc2F2ZUFuZFJlbmRlckxpc3QoKTtcbiAgICAgICAgICAgIHJlbmRlclRhc2tzKCk7XG4gICAgICAgICAgICBkaXJlY3RvcnlNb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgICAgICAgICAgIGVkaXREaXJCdG4ucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZWRpdERpckZvcm0pO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY2xvc2VFZGl0RGlyID0gKCkgPT4ge1xuICAgICAgICAgICAgZGlyZWN0b3J5TW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG4gICAgICAgICAgICBlZGl0RGlyQnRuLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGVkaXREaXJGb3JtKTtcbiAgICAgICAgICAgIGNsb3NlRWRpdERpckJ0bi5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlRWRpdERpcik7XG4gICAgICAgIH1cblxuICAgICAgICBjbG9zZUVkaXREaXJCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZUVkaXREaXIpO1xuICAgICAgICBlZGl0RGlyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGVkaXREaXJGb3JtKTtcbiAgICB9XG4gICAgXG5cbn1cblxuLy9jcmVhdGVzIGEgZGlyZWN0b3J5IGZvbGRlciBvYmplY3QgdG8gYmUgcHVzaGVkIGludG8gZGlyZWN0b3J5IGFycmF5XG5jb25zdCBjcmVhdGVOZXdEaXIgPSAoZGlyKSA9PiB7XG4gICByZXR1cm4geyBpZDogRGF0ZS5ub3coKS50b1N0cmluZygpLCBuYW1lOiBkaXIsIHRhc2tzOiBbXSB9XG59XG5cbmV4cG9ydCB7IHJlbmRlckxpc3RzLCBjcmVhdGVEaXJMaXN0ZW5lciwgc2F2ZUFuZFJlbmRlckxpc3QsIGRpcmVjdG9yeUFyciwgc2VsZWN0ZWRGb2xkZXIsIGNsZWFyTGlzdCwgc2F2ZSB9IiwiaW1wb3J0IHsgY3JlYXRlRGlyTGlzdGVuZXIsIHNhdmVBbmRSZW5kZXJMaXN0LCByZW5kZXJMaXN0cywgZGlyZWN0b3J5QXJyLCBzZWxlY3RlZEZvbGRlciB9IGZyb20gXCIuL2RpcmVjdG9yeS1jcmVhdG9yXCI7XG5pbXBvcnQgeyB0b2dnbGVUaGVtZSB9IGZyb20gXCIuL3RvZ2dsZVRoZW1lXCI7XG5pbXBvcnQgeyByZW5kZXJUYXNrcywgbGlzdExpc3RlbmVycyB9IGZyb20gXCIuL2xpc3QtY3JlYXRvclwiXG5pbXBvcnQgeyBkaXNwbGF5RGF0ZSB9IGZyb20gXCIuL2RhdGVcIjtcblxuZnVuY3Rpb24gY3JlYXRlSFRNTEVsZW1lbnQodHlwZSwgaWQsIGNsYXNzZXMsIGNvbnRlbnQpIHtcbiAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0eXBlKTtcblxuICAgIGlmKGlkKSBlbGVtZW50LmlkID0gaWQ7XG4gICAgaWYoY2xhc3Nlcykge1xuICAgICAgICBjbGFzc2VzLmZvckVhY2goKG15Q2xhc3MpID0+IGVsZW1lbnQuY2xhc3NMaXN0LmFkZChteUNsYXNzKSk7XG4gICAgfTtcbiAgICBpZihjb250ZW50KSBlbGVtZW50LnRleHRDb250ZW50ID0gY29udGVudDtcblxuICAgIHJldHVybiBlbGVtZW50O1xufTtcblxuY29uc3QgcmVuZGVyID0gKCkgPT4ge1xuICAgIHNhdmVBbmRSZW5kZXJMaXN0KCk7XG4gICAgcmVuZGVyVGFza3MoKTtcbn1cblxuY29uc3Qgb25Mb2FkID0gKCkgPT4ge1xuICAgIHRvZ2dsZVRoZW1lKCk7XG4gICAgcmVuZGVyKCk7XG4gICAgY3JlYXRlRGlyTGlzdGVuZXIoKTtcbiAgICBsaXN0TGlzdGVuZXJzKCk7IFxuICAgIGRpc3BsYXlEYXRlKCk7XG59XG5cbm9uTG9hZCgpO1xuXG5leHBvcnQge1xuICAgIGNyZWF0ZUhUTUxFbGVtZW50LCByZW5kZXJcbn0iLCJjb25zdCB0b2dnbGVUaGVtZSA9ICgpID0+IHtcblxuY29uc3QgdG9nZ2xlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxpZ2h0LWRhcmstbW9kZScpO1xudG9nZ2xlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlTW9kZSk7XG5cbmZ1bmN0aW9uIHRvZ2dsZU1vZGUoKSB7XG4gICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnKTtcbiAgICB0b2dnbGUuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJyk7XG5cbiAgICBjb25zdCBjdXJyZW50VGhlbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY3VycmVudC10aGVtZScpO1xuXG4gICAgaWYodG9nZ2xlLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykpIHsgXG4gICAgICAgIGN1cnJlbnRUaGVtZS50ZXh0Q29udGVudCA9ICdEYXJrIE1vZGUnO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGN1cnJlbnRUaGVtZS50ZXh0Q29udGVudCA9ICdMaWdodCBNb2RlJztcbiAgICB9O1xufVxufVxuXG5leHBvcnQgeyB0b2dnbGVUaGVtZSB9Il0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJleHBvcnRzIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiZm9ybWF0QU1QTSIsImQiLCJEYXRlIiwibWludXRlcyIsImdldE1pbnV0ZXMiLCJ0b1N0cmluZyIsImxlbmd0aCIsImhvdXJzIiwiZ2V0SG91cnMiLCJhbXBtIiwiZ2V0RGF5IiwiZ2V0TW9udGgiLCJnZXREYXRlIiwiZ2V0RnVsbFllYXIiLCJmb2xkZXJEaXNwbGF5Q29udGFpbmVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZm9sZGVyVGl0bGUiLCJ0YXNrQ291bnQiLCJ0YXNrQ29udGFpbmVyIiwidGFza1RlbXBsYXRlIiwicmVuZGVyVGFza051bSIsInNlbGVjdGVkVGFza051bSIsImluY29tcGxldGUiLCJ0YXNrcyIsImZpbHRlciIsInRhc2siLCJjb21wbGV0ZSIsInRhc2tzU3RyaW5nIiwidGV4dENvbnRlbnQiLCJyZW5kZXJUYXNrcyIsInNlbGVjdGVkTGlzdCIsImRpcmVjdG9yeUFyciIsImZpbmQiLCJsaXN0IiwiaWQiLCJzZWxlY3RlZEZvbGRlciIsInN0eWxlIiwiZGlzcGxheSIsIm5hbWUiLCJjbGVhckxpc3QiLCJmb3JFYWNoIiwidGFza0RPTSIsImltcG9ydE5vZGUiLCJjb250ZW50IiwiY2hlY2tCb3giLCJjaGVja2VkIiwidGFza0Rlc2MiLCJkZXNjIiwidGFza0RhdGUiLCJkYXRlIiwicG9zdGVkIiwiaW5uZXJIVE1MIiwiYXBwZW5kQ2hpbGQiLCJjcmVhdGVUYXNrIiwibm93IiwiTE9DQUxfU1RPUkFHRV9ESVJfS0VZIiwiTE9DQUxfU1RPUkFHRV9GT0xERVJfS0VZIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsIkpTT04iLCJwYXJzZSIsInNhdmVBbmRSZW5kZXJMaXN0Iiwic2F2ZSIsInJlbmRlckxpc3RzIiwic2V0SXRlbSIsInN0cmluZ2lmeSIsImRpcmVjdG9yeUNvbnRhaW5lciIsImRpcmVjdG9yeSIsImRpcmVjdG9yeUZvbGRlciIsImNyZWF0ZUhUTUxFbGVtZW50IiwiZGF0YXNldCIsImxpc3RJZCIsImNsYXNzTGlzdCIsImFkZCIsImRpcmVjdG9yeUZvbGRlckljb25zIiwiY29udGFpbnMiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJjcmVhdGVEaXJlY3RvcnkiLCJlIiwiZGlyVGV4dCIsInByZXZlbnREZWZhdWx0IiwiZGlyTmFtZSIsInZhbHVlIiwiY3JlYXRlTmV3RGlyIiwicHVzaCIsInNlbGVjdGVkRGlyZWN0b3J5TGlzdGVuZXIiLCJ0YXJnZXQiLCJ0YWdOYW1lIiwidG9Mb3dlckNhc2UiLCJkZWxldGVEaXIiLCJwYXJlbnRFbGVtZW50IiwicmVuZGVyIiwiZWRpdERpciIsImRpcmVjdG9yeU1vZGFsIiwidG9nZ2xlIiwiZWRpdERpckJ0biIsImNsb3NlRWRpdERpckJ0biIsImVkaXREaXJGb3JtIiwiZGlyZWN0b3J5TW9kYWxUZXh0IiwiZGlyZWN0b3J5UmVOYW1lIiwiZGlyIiwicmVtb3ZlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImNsb3NlRWRpdERpciIsImFkZEV2ZW50TGlzdGVuZXIiLCJ0eXBlIiwiY2xhc3NlcyIsImVsZW1lbnQiLCJjcmVhdGVFbGVtZW50IiwibXlDbGFzcyIsImJvZHkiLCJjdXJyZW50VGhlbWUiLCJ0b2dnbGVUaGVtZSIsImRpckZvcm0iLCJkaXJDb250YWluZXIiLCJjcmVhdGVEaXJMaXN0ZW5lciIsImxpc3RNb2RhbCIsInRhc2tJbnB1dE5hbWUiLCJ0YXNrSW5wdXREZXNjIiwidGFza0lucHV0RGF0ZSIsInRhc2tQb3N0ZWQiLCJ0YXNrTmFtZSIsInNlbGVjdGVkRWxlbWVudCIsInBhcmVudE5vZGUiLCJzZWxlY3RlZFRhc2siLCJBcnJheSIsImZyb20iLCJjaGlsZHJlbiIsImluZGV4T2YiLCJpdGVtcyIsInRhc2tFZGl0TW9kYWwiLCJ0YXNrRWRpdEZvcm0iLCJzdWJtaXRUYXNrRWRpdCIsImNvbnNvbGUiLCJsb2ciXSwic291cmNlUm9vdCI6IiJ9