(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{N:()=>x,s:()=>E});const t=document.querySelector("#to-do-list"),n=document.querySelector(".to-do-title"),o=document.querySelector(".task-count"),r=document.querySelector(".tasks"),c=document.querySelector("#task-template"),s=()=>{const e=v.find((e=>e.id===m));null==e?t.style.display="none":(t.style.display="",n.textContent=e.name,(e=>{const t=e.tasks.filter((e=>!e.complete)).length,n=1===t?"task":"tasks";o.textContent=`${t} ${n} remaining`})(e),h(r),e.tasks.forEach((e=>{const t=document.importNode(c.content,!0),n=t.querySelector("input");n.id=e.id,n.checked=e.complete,t.querySelector(".task-name").textContent=e.name;const o=t.querySelector(".task-desc");e.desc?o.textContent=` Description: ${e.desc}`:o.textContent="No Description.";const s=t.querySelector(".task-date");e.date?s.textContent=` Complete by: ${e.date}`:s.textContent="No Completion Date.",r.appendChild(t)})))},l=()=>{document.querySelector(".modal-container").classList.add("active")},a=e=>{e.preventDefault();const t=document.querySelector(".modal-container"),n=document.querySelector("#task"),o=document.querySelector("#description"),r=document.querySelector("#date"),c=n.value;if(null==c||""===c)return;const s=o.value,l=r.value,a=i(c,s,l);n.value=null,o.value=null,r.value=null,v.find((e=>e.id===m)).tasks.push(a),t.classList.remove("active"),E()},i=(e,t,n)=>({id:Date.now().toString(),name:e,desc:t,date:n,complete:!1}),d="task.list",u="task.selectedFolder";let m=localStorage.getItem(u),v=JSON.parse(localStorage.getItem(d))||[];const y=()=>{p(),f()},p=()=>{localStorage.setItem(d,JSON.stringify(v)),localStorage.setItem(u,m)},f=()=>{const e=document.querySelector(".directory");h(e),v.forEach((t=>{const n=x("li",null,["directory-folder"],t.name);n.dataset.listId=t.id,t.id===m&&n.classList.add("directory-active"),e.appendChild(n);const o=x("span",null,["directory-folder-icons"],null);o.innerHTML='<button class="button-edit"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-edit" width="18" height="18" viewBox="0 0 24 24" stroke-width="1.5" stroke="#ffffff" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" /><line x1="13.5" y1="6.5" x2="17.5" y2="10.5" /></svg></button><button class="button-trash"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-trash" width="18" height="18" viewBox="0 0 24 24" stroke-width="1.5" stroke="#ffffff" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="4" y1="7" x2="20" y2="7" /><line x1="10" y1="11" x2="10" y2="17" /><line x1="14" y1="11" x2="14" y2="17" /><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" /><path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" /></svg></button>',n.classList.contains("directory-active")&&n.appendChild(o)}))},h=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)},g=e=>{const t=document.querySelector(".add-dir-btn-text");e.preventDefault();const n=t.value;if(null==n||""===n)return;const o=q(n);t.value=null,v.push(o),y()},k=e=>{"li"===e.target.tagName.toLowerCase()&&(m=e.target.dataset.listId,y(),s())},S=e=>{e.target.classList.contains("icon-trash")&&e.target.parentElement.parentElement.parentElement.dataset.listId===m&&(v=v.filter((e=>e.id!==m)),m=null,E())},L=e=>{if(e.target.classList.contains("icon-edit")&&e.target.parentElement.parentElement.parentElement.dataset.listId===m){const e=document.querySelector(".directory-modal-container");e.classList.toggle("active");const t=document.querySelector("#directory-edit-form"),n=document.querySelector(".icon-tabler-square-x");console.log("click");const o=n=>{n.preventDefault();const r=document.querySelector("#text-dir"),c=r.value;null!=c&&""!==c&&(v.forEach((e=>{e.id===m&&(e.name=c)})),r.value=null,y(),e.classList.remove("active"),t.removeEventListener("submit",o))},r=()=>{e.classList.remove("active"),t.removeEventListener("submit",o),n.removeEventListener("click",r)};n.addEventListener("click",r),t.addEventListener("submit",o)}},q=e=>({id:Date.now().toString(),name:e,tasks:[]});function x(e,t,n,o){const r=document.createElement(e);return t&&(r.id=t),n&&n.forEach((e=>r.classList.add(e))),o&&(r.textContent=o),r}const E=()=>{y(),s()};(()=>{const e=document.querySelector(".light-dark-mode");e.addEventListener("click",(function(){document.body.classList.toggle("active"),e.classList.toggle("active");const t=document.querySelector(".current-theme");e.classList.contains("active")?t.textContent="Dark Mode":t.textContent="Light Mode"}))})(),E(),(()=>{const e=document.querySelector("#add-dir-form"),t=document.querySelector(".directory");e.addEventListener("submit",g),t.addEventListener("click",k),t.addEventListener("click",S),t.addEventListener("click",L)})(),document.querySelector(".create-task-btn").addEventListener("click",l),document.querySelector("#add-task").addEventListener("submit",a)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEdBQUtBLEdBQ2pCNkYsR0FDQ0EsRUFBUTdFLFNBQVNnRixHQUFZRixFQUFRbEUsVUFBVUMsSUFBSW1FLEtBRXBEN0UsSUFBUzJFLEVBQVExRixZQUFjZSxHQUUzQjJFLEVBR1gsTUFBTXBELEVBQVMsS0FDWFUsSUFDQXpELEtDbEJnQixNQUVwQixNQUFNcUYsRUFBUzNGLFNBQVNDLGNBQWMsb0JBQ3RDMEYsRUFBT1csaUJBQWlCLFNBRXhCLFdBQ0l0RyxTQUFTNEcsS0FBS3JFLFVBQVVvRCxPQUFPLFVBQy9CQSxFQUFPcEQsVUFBVW9ELE9BQU8sVUFFeEIsTUFBTWtCLEVBQWU3RyxTQUFTQyxjQUFjLGtCQUV6QzBGLEVBQU9wRCxVQUFVcUMsU0FBUyxVQUN6QmlDLEVBQWE5RixZQUFjLFlBRTNCOEYsRUFBYTlGLFlBQWMsaUJEUW5DK0YsR0FDQXpELElENkIwQixNQUN0QixNQUFNMEQsRUFBVS9HLFNBQVNDLGNBQWMsaUJBQ2pDK0csRUFBZWhILFNBQVNDLGNBQWMsY0FFNUM4RyxFQUFRVCxpQkFBaUIsU0FBVXZCLEdBQ25DaUMsRUFBYVYsaUJBQWlCLFFBQVNuQixHQUN2QzZCLEVBQWFWLGlCQUFpQixRQUFTZixHQUN2Q3lCLEVBQWFWLGlCQUFpQixRQUFTYixJQ25DM0N3QixHRmIwQmpILFNBQVNDLGNBQWMsb0JBQy9CcUcsaUJBQWlCLFFBQVNoRSxHQUVyQnRDLFNBQVNDLGNBQWMsYUFDL0JxRyxpQkFBaUIsU0FBVTdELEkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90by1kby1hcHAvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vdG8tZG8tYXBwL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly90by1kby1hcHAvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly90by1kby1hcHAvLi9zcmMvbGlzdC1jcmVhdG9yLmpzIiwid2VicGFjazovL3RvLWRvLWFwcC8uL3NyYy9kaXJlY3RvcnktY3JlYXRvci5qcyIsIndlYnBhY2s6Ly90by1kby1hcHAvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vdG8tZG8tYXBwLy4vc3JjL3RvZ2dsZVRoZW1lLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiaW1wb3J0IHsgY3JlYXRlSFRNTEVsZW1lbnQsIHJlbmRlciB9IGZyb20gXCIuL2luZGV4XCI7XG5pbXBvcnQgeyByZW5kZXJMaXN0cywgY3JlYXRlRGlyTGlzdGVuZXIsIHNhdmVBbmRSZW5kZXJMaXN0LCBkaXJlY3RvcnlBcnIsIHNlbGVjdGVkRm9sZGVyLCBjbGVhckxpc3QgfSBmcm9tIFwiLi9kaXJlY3RvcnktY3JlYXRvclwiO1xuXG5jb25zdCBmb2xkZXJEaXNwbGF5Q29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3RvLWRvLWxpc3QnKTtcbmNvbnN0IGZvbGRlclRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRvLWRvLXRpdGxlJyk7XG5jb25zdCB0YXNrQ291bnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGFzay1jb3VudCcpO1xuY29uc3QgdGFza0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50YXNrcycpO1xuY29uc3QgdGFza1RlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Rhc2stdGVtcGxhdGUnKTtcblxuXG5jb25zdCBsaXN0TGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIGNvbnN0IGNyZWF0ZVRhc2tCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY3JlYXRlLXRhc2stYnRuJyk7XG4gICAgY3JlYXRlVGFza0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNyZWF0ZVRhc2tNb2RhbClcblxuICAgIGNvbnN0IHN1Ym1pdFRhc2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYWRkLXRhc2snKTtcbiAgICBzdWJtaXRUYXNrLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHN1Ym1pdEZvcm0pO1xuXG4gICAgXG59XG5cbmNvbnN0IHJlbmRlclRhc2tOdW0gPSAoc2VsZWN0ZWRUYXNrTnVtKSA9PiB7XG4gICAgY29uc3QgaW5jb21wbGV0ZSA9IHNlbGVjdGVkVGFza051bS50YXNrcy5maWx0ZXIodGFzayA9PiAhdGFzay5jb21wbGV0ZSkubGVuZ3RoO1xuICAgIGNvbnN0IHRhc2tzU3RyaW5nID0gaW5jb21wbGV0ZSA9PT0gMSA/IFwidGFza1wiIDogXCJ0YXNrc1wiO1xuICAgIHRhc2tDb3VudC50ZXh0Q29udGVudCA9IGAke2luY29tcGxldGV9ICR7dGFza3NTdHJpbmd9IHJlbWFpbmluZ2A7XG59XG5cbmNvbnN0IHJlbmRlclRhc2tMaXN0ID0gKHNlbGVjdGVkVGFza0xpc3QpID0+IHtcbiAgICBzZWxlY3RlZFRhc2tMaXN0LnRhc2tzLmZvckVhY2godGFzayA9PiB7XG4gICAgICAgIGNvbnN0IHRhc2tET00gPSBkb2N1bWVudC5pbXBvcnROb2RlKHRhc2tUZW1wbGF0ZS5jb250ZW50LCB0cnVlKVxuICAgICAgICBjb25zdCBjaGVja0JveCA9IHRhc2tET00ucXVlcnlTZWxlY3RvcignaW5wdXQnKTtcbiAgICAgICAgY2hlY2tCb3guaWQgPSB0YXNrLmlkO1xuICAgICAgICBjaGVja0JveC5jaGVja2VkID0gdGFzay5jb21wbGV0ZTtcbiAgICAgICAgY29uc3QgdGFza05hbWUgPSAgdGFza0RPTS5xdWVyeVNlbGVjdG9yKCcudGFzay1uYW1lJyk7XG4gICAgICAgIHRhc2tOYW1lLnRleHRDb250ZW50ID0gdGFzay5uYW1lO1xuXG4gICAgICAgIGNvbnN0IHRhc2tEZXNjID0gdGFza0RPTS5xdWVyeVNlbGVjdG9yKCcudGFzay1kZXNjJylcbiAgICAgICAgdGFzay5kZXNjID8gdGFza0Rlc2MudGV4dENvbnRlbnQgPSBgIERlc2NyaXB0aW9uOiAke3Rhc2suZGVzY31gIDogdGFza0Rlc2MudGV4dENvbnRlbnQgPSAnTm8gRGVzY3JpcHRpb24uJztcbiAgICAgICBcbiAgICAgICAgY29uc3QgdGFza0RhdGUgPSB0YXNrRE9NLnF1ZXJ5U2VsZWN0b3IoJy50YXNrLWRhdGUnKTtcbiAgICAgICAgdGFzay5kYXRlID8gdGFza0RhdGUudGV4dENvbnRlbnQgPSBgIENvbXBsZXRlIGJ5OiAke3Rhc2suZGF0ZX1gIDogdGFza0RhdGUudGV4dENvbnRlbnQgPSAnTm8gQ29tcGxldGlvbiBEYXRlLic7XG5cbiAgICAgICAgdGFza0NvbnRhaW5lci5hcHBlbmRDaGlsZCh0YXNrRE9NKTtcbiAgICB9KVxuICAgIFxufVxuXG5cbmNvbnN0IHJlbmRlclRhc2tzID0gKCkgPT4ge1xuICAgIGNvbnN0IHNlbGVjdGVkTGlzdCA9IGRpcmVjdG9yeUFyci5maW5kKGxpc3QgPT4gbGlzdC5pZCA9PT0gc2VsZWN0ZWRGb2xkZXIpO1xuXG4gICAgaWYoc2VsZWN0ZWRMaXN0ID09IG51bGwpIHtcbiAgICAgICAgZm9sZGVyRGlzcGxheUNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGZvbGRlckRpc3BsYXlDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgICAgICBmb2xkZXJUaXRsZS50ZXh0Q29udGVudCA9IHNlbGVjdGVkTGlzdC5uYW1lO1xuICAgICAgICByZW5kZXJUYXNrTnVtKHNlbGVjdGVkTGlzdCk7XG4gICAgICAgIGNsZWFyTGlzdCh0YXNrQ29udGFpbmVyKTtcbiAgICAgICAgcmVuZGVyVGFza0xpc3Qoc2VsZWN0ZWRMaXN0KTtcbiAgICB9XG59XG5cbi8vWU9VIFdFUkUgTEFTVCBIRVJFIFdPUktJTkcgT04gVEhJUyBORUVEIFRPIFRPR0dMRSBDTEFTUyBUTyBESVNQTEFZIE1PREFMIFRPIElOUFVUIE5FVyBUQVNLKioqKioqKlxuY29uc3QgY3JlYXRlVGFza01vZGFsID0gKCkgPT4ge1xuICAgIGNvbnN0IGxpc3RNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1jb250YWluZXInKVxuICAgIGxpc3RNb2RhbC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcbn1cblxuY29uc3Qgc3VibWl0Rm9ybSA9IChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNvbnN0IGxpc3RNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1jb250YWluZXInKVxuICAgIGNvbnN0IHRhc2tJbnB1dE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdGFzaycpO1xuICAgIGNvbnN0IHRhc2tJbnB1dERlc2MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZGVzY3JpcHRpb24nKTtcbiAgICBjb25zdCB0YXNrSW5wdXREYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2RhdGUnKTtcbiAgICBcbiAgICBjb25zdCB0YXNrTmFtZSA9IHRhc2tJbnB1dE5hbWUudmFsdWU7XG4gICAgaWYodGFza05hbWUgPT0gbnVsbCB8fCB0YXNrTmFtZSA9PT0gJycpIHJldHVybjtcbiAgICBjb25zdCB0YXNrRGVzYyA9IHRhc2tJbnB1dERlc2MudmFsdWU7XG4gICAgY29uc3QgdGFza0RhdGUgPSB0YXNrSW5wdXREYXRlLnZhbHVlXG4gICAgY29uc3QgdGFzayA9IGNyZWF0ZVRhc2sodGFza05hbWUsIHRhc2tEZXNjLCB0YXNrRGF0ZSk7XG4gICAgdGFza0lucHV0TmFtZS52YWx1ZSA9IG51bGw7XG4gICAgdGFza0lucHV0RGVzYy52YWx1ZSA9IG51bGw7XG4gICAgdGFza0lucHV0RGF0ZS52YWx1ZSA9IG51bGw7XG4gICAgY29uc3Qgc2VsZWN0ZWRMaXN0ID0gZGlyZWN0b3J5QXJyLmZpbmQobGlzdCA9PiBsaXN0LmlkID09PSBzZWxlY3RlZEZvbGRlcik7XG4gICAgc2VsZWN0ZWRMaXN0LnRhc2tzLnB1c2godGFzayk7XG4gICAgbGlzdE1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgIHJlbmRlcigpO1xufVxuXG5jb25zdCBjcmVhdGVUYXNrID0gKHRhc2ssIGRlc2MsIGRhdGUpID0+IHtcbiAgICByZXR1cm4geyAgaWQ6IERhdGUubm93KCkudG9TdHJpbmcoKSwgbmFtZTogdGFzaywgZGVzYzogZGVzYywgZGF0ZTogZGF0ZSwgY29tcGxldGU6IGZhbHNlLCAgfVxufVxuXG5cbmV4cG9ydCB7IHJlbmRlclRhc2tzLCBsaXN0TGlzdGVuZXJzIH0iLCJpbXBvcnQgeyBjcmVhdGVIVE1MRWxlbWVudCwgcmVuZGVyIH0gZnJvbSBcIi4vaW5kZXhcIjtcbmltcG9ydCB7IHJlbmRlclRhc2tzIH0gZnJvbSBcIi4vbGlzdC1jcmVhdG9yXCI7XG5cbmNvbnN0IExPQ0FMX1NUT1JBR0VfRElSX0tFWSA9ICd0YXNrLmxpc3QnO1xuY29uc3QgTE9DQUxfU1RPUkFHRV9GT0xERVJfS0VZID0gJ3Rhc2suc2VsZWN0ZWRGb2xkZXInO1xuXG4vL2xvY2FsIHN0b3JhZ2Uga2V5cyArIGFycmF5XG5sZXQgc2VsZWN0ZWRGb2xkZXIgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShMT0NBTF9TVE9SQUdFX0ZPTERFUl9LRVkpXG5sZXQgZGlyZWN0b3J5QXJyID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShMT0NBTF9TVE9SQUdFX0RJUl9LRVkpKSB8fCBbXTsgXG5cbmNvbnN0IHNhdmVBbmRSZW5kZXJMaXN0ID0gKCkgPT4ge1xuICAgIHNhdmUoKTtcbiAgICByZW5kZXJMaXN0cygpO1xufVxuXG4vL3NhdmVzIHRvIGxvY2FsIHN0b3JhZ2VcbmNvbnN0IHNhdmUgPSAoKSA9PiB7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oTE9DQUxfU1RPUkFHRV9ESVJfS0VZLCBKU09OLnN0cmluZ2lmeShkaXJlY3RvcnlBcnIpKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShMT0NBTF9TVE9SQUdFX0ZPTERFUl9LRVksIHNlbGVjdGVkRm9sZGVyKTtcbn1cblxuLy9yZW5kZXJzIHRoZSBkaXJlY3RvcnkgbGlzdFxuY29uc3QgcmVuZGVyTGlzdHMgPSAoKSA9PiB7XG4gICAgY29uc3QgZGlyZWN0b3J5Q29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRpcmVjdG9yeScpO1xuXG4gICAgY2xlYXJMaXN0KGRpcmVjdG9yeUNvbnRhaW5lcik7XG4gICAgZGlyZWN0b3J5QXJyLmZvckVhY2goZGlyZWN0b3J5ID0+IHtcbiAgICAgICBjb25zdCBkaXJlY3RvcnlGb2xkZXIgPSBjcmVhdGVIVE1MRWxlbWVudCgnbGknLCBudWxsLCBbJ2RpcmVjdG9yeS1mb2xkZXInXSwgZGlyZWN0b3J5Lm5hbWUpXG4gICAgICAgZGlyZWN0b3J5Rm9sZGVyLmRhdGFzZXQubGlzdElkID0gZGlyZWN0b3J5LmlkO1xuICAgICAgIC8vaWYgdGhlIGZvbGRlciBpcyBzZWxlY3RlZCwgbWFrZSBpdCBhY3RpdmUgZm9sZGVyXG4gICAgICAgaWYoZGlyZWN0b3J5LmlkID09PSBzZWxlY3RlZEZvbGRlcikge1xuICAgICAgICAgICBkaXJlY3RvcnlGb2xkZXIuY2xhc3NMaXN0LmFkZCgnZGlyZWN0b3J5LWFjdGl2ZScpO1xuICAgICAgIH07XG4gICAgICAgZGlyZWN0b3J5Q29udGFpbmVyLmFwcGVuZENoaWxkKGRpcmVjdG9yeUZvbGRlcik7IFxuXG4gICAgICAgY29uc3QgZGlyZWN0b3J5Rm9sZGVySWNvbnMgPSBjcmVhdGVIVE1MRWxlbWVudCgnc3BhbicsIG51bGwsIFsnZGlyZWN0b3J5LWZvbGRlci1pY29ucyddLCBudWxsKTtcbiAgICAgICBkaXJlY3RvcnlGb2xkZXJJY29ucy5pbm5lckhUTUwgPSAnPGJ1dHRvbiBjbGFzcz1cImJ1dHRvbi1lZGl0XCI+PHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgY2xhc3M9XCJpY29uIGljb24tZWRpdFwiIHdpZHRoPVwiMThcIiBoZWlnaHQ9XCIxOFwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBzdHJva2Utd2lkdGg9XCIxLjVcIiBzdHJva2U9XCIjZmZmZmZmXCIgZmlsbD1cIm5vbmVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj48cGF0aCBzdHJva2U9XCJub25lXCIgZD1cIk0wIDBoMjR2MjRIMHpcIiBmaWxsPVwibm9uZVwiLz48cGF0aCBkPVwiTTQgMjBoNGwxMC41IC0xMC41YTEuNSAxLjUgMCAwIDAgLTQgLTRsLTEwLjUgMTAuNXY0XCIgLz48bGluZSB4MT1cIjEzLjVcIiB5MT1cIjYuNVwiIHgyPVwiMTcuNVwiIHkyPVwiMTAuNVwiIC8+PC9zdmc+PC9idXR0b24+PGJ1dHRvbiBjbGFzcz1cImJ1dHRvbi10cmFzaFwiPjxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIGNsYXNzPVwiaWNvbiBpY29uLXRyYXNoXCIgd2lkdGg9XCIxOFwiIGhlaWdodD1cIjE4XCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHN0cm9rZS13aWR0aD1cIjEuNVwiIHN0cm9rZT1cIiNmZmZmZmZcIiBmaWxsPVwibm9uZVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPjxwYXRoIHN0cm9rZT1cIm5vbmVcIiBkPVwiTTAgMGgyNHYyNEgwelwiIGZpbGw9XCJub25lXCIvPjxsaW5lIHgxPVwiNFwiIHkxPVwiN1wiIHgyPVwiMjBcIiB5Mj1cIjdcIiAvPjxsaW5lIHgxPVwiMTBcIiB5MT1cIjExXCIgeDI9XCIxMFwiIHkyPVwiMTdcIiAvPjxsaW5lIHgxPVwiMTRcIiB5MT1cIjExXCIgeDI9XCIxNFwiIHkyPVwiMTdcIiAvPjxwYXRoIGQ9XCJNNSA3bDEgMTJhMiAyIDAgMCAwIDIgMmg4YTIgMiAwIDAgMCAyIC0ybDEgLTEyXCIgLz48cGF0aCBkPVwiTTkgN3YtM2ExIDEgMCAwIDEgMSAtMWg0YTEgMSAwIDAgMSAxIDF2M1wiIC8+PC9zdmc+PC9idXR0b24+JztcbiAgICAgICAvL2lmIHRoZSBmb2xkZXIgaXMgc2VsZWN0ZWQsIGFkZCB0aGUgaWNvbnNcbiAgICAgICBpZihkaXJlY3RvcnlGb2xkZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdkaXJlY3RvcnktYWN0aXZlJykpIHtcbiAgICAgICBkaXJlY3RvcnlGb2xkZXIuYXBwZW5kQ2hpbGQoZGlyZWN0b3J5Rm9sZGVySWNvbnMpO1xuICAgICAgIH07XG4gICAgfSlcbn07XG5cbi8vY2xlYXJzIHRoZSBkaXJlY3RvcnkgbGlzdCB0byBiZSByZS1yZW5kZXJlZCBpbiByZW5kZXJMaXN0c1xuY29uc3QgY2xlYXJMaXN0ID0gKGxpc3QpID0+IHtcbiAgICB3aGlsZShsaXN0LmZpcnN0Q2hpbGQpIHtcbiAgICAgICAgbGlzdC5yZW1vdmVDaGlsZChsaXN0LmZpcnN0Q2hpbGQpXG4gICAgfVxufTtcblxuLy9hZGRzIGV2ZW50bGlzdGVuZXJzIGZvciB0aGUgZGlyZWN0b3J5XG5jb25zdCBjcmVhdGVEaXJMaXN0ZW5lciA9ICgpID0+IHtcbiAgICBjb25zdCBkaXJGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2FkZC1kaXItZm9ybScpO1xuICAgIGNvbnN0IGRpckNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kaXJlY3RvcnknKTtcblxuICAgIGRpckZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgY3JlYXRlRGlyZWN0b3J5KVxuICAgIGRpckNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNlbGVjdGVkRGlyZWN0b3J5TGlzdGVuZXIpXG4gICAgZGlyQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZGVsZXRlRGlyKVxuICAgIGRpckNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGVkaXREaXIpXG59XG5cbi8vY3JlYXRlcyBhIG5ldyBkaXJlY3RvcnkgZm9sZGVyXG5jb25zdCBjcmVhdGVEaXJlY3RvcnkgPSAoZSkgPT4ge1xuICAgIGNvbnN0IGRpclRleHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkLWRpci1idG4tdGV4dCcpO1xuXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNvbnN0IGRpck5hbWUgPSBkaXJUZXh0LnZhbHVlO1xuICAgIGlmKGRpck5hbWUgPT0gbnVsbCB8fCBkaXJOYW1lID09PSAnJykgcmV0dXJuO1xuICAgIGNvbnN0IGRpcmVjdG9yeSA9IGNyZWF0ZU5ld0RpcihkaXJOYW1lKTtcbiAgICBkaXJUZXh0LnZhbHVlID0gbnVsbDtcbiAgICBkaXJlY3RvcnlBcnIucHVzaChkaXJlY3RvcnkpO1xuICAgIHNhdmVBbmRSZW5kZXJMaXN0KCk7XG59XG5cbi8vZnVuY3Rpb24gZm9yIHRoZSBzZWxlY3RlZCBkaXJlY3RvcnkgbGlzdGVuZXJcbmNvbnN0IHNlbGVjdGVkRGlyZWN0b3J5TGlzdGVuZXIgPSAoZSkgPT4ge1xuICAgIGlmKGUudGFyZ2V0LnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2xpJykge1xuICAgICAgICBzZWxlY3RlZEZvbGRlciA9IGUudGFyZ2V0LmRhdGFzZXQubGlzdElkO1xuICAgICAgICBzYXZlQW5kUmVuZGVyTGlzdCgpO1xuICAgICAgICByZW5kZXJUYXNrcygpO1xuICAgIH1cbn1cblxuLy9mdW5jdGlvbiBmb3IgdGhlIGRlbGV0ZWRpciBsaXN0ZW5lciBcbmNvbnN0IGRlbGV0ZURpciA9IChlKSA9PiB7XG4gICAgaWYoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdpY29uLXRyYXNoJykgJiYgZS50YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuZGF0YXNldC5saXN0SWQgPT09IHNlbGVjdGVkRm9sZGVyKSB7XG4gICAgICAgIGRpcmVjdG9yeUFyciA9IGRpcmVjdG9yeUFyci5maWx0ZXIoZGlyZWN0b3J5ID0+IGRpcmVjdG9yeS5pZCAhPT0gc2VsZWN0ZWRGb2xkZXIpO1xuICAgICAgICBzZWxlY3RlZEZvbGRlciA9IG51bGw7XG4gICAgICAgIC8vIHNhdmVBbmRSZW5kZXJMaXN0KCk7XG4gICAgICAgIC8vIHJlbmRlclRhc2tzKCk7XG4gICAgICAgIHJlbmRlcigpO1xuICAgIH1cbn1cbi8vRWRpdGluZyB0aGUgZGlyZWN0b3J5IGZvbGRlciB0aXRsZSBhbmQgdXBkYXRpbmcgdGhlIGFycmF5ICsgRE9NXG5jb25zdCBlZGl0RGlyID0gKGUpID0+IHtcbiAgICBpZihlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2ljb24tZWRpdCcpICYmIGUudGFyZ2V0LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LmRhdGFzZXQubGlzdElkID09PSBzZWxlY3RlZEZvbGRlcikge1xuICAgICAgICBjb25zdCBkaXJlY3RvcnlNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kaXJlY3RvcnktbW9kYWwtY29udGFpbmVyJyk7XG4gICAgICAgIGRpcmVjdG9yeU1vZGFsLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScpO1xuICAgICAgICBjb25zdCBlZGl0RGlyQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2RpcmVjdG9yeS1lZGl0LWZvcm0nKTtcbiAgICAgICAgY29uc3QgY2xvc2VFZGl0RGlyQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmljb24tdGFibGVyLXNxdWFyZS14Jyk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdjbGljaycpO1xuXG4gICAgICAgIGNvbnN0IGVkaXREaXJGb3JtID0gKGUpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGNvbnN0IGRpcmVjdG9yeU1vZGFsVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0ZXh0LWRpcicpO1xuICAgICAgICAgICAgY29uc3QgZGlyZWN0b3J5UmVOYW1lID0gZGlyZWN0b3J5TW9kYWxUZXh0LnZhbHVlO1xuICAgICAgICAgICAgaWYoZGlyZWN0b3J5UmVOYW1lID09IG51bGwgfHwgZGlyZWN0b3J5UmVOYW1lID09PSAnJykgcmV0dXJuO1xuICAgICAgICAgICAgZGlyZWN0b3J5QXJyLmZvckVhY2goZGlyID0+IHtcbiAgICAgICAgICAgICAgICBpZihkaXIuaWQgPT09IHNlbGVjdGVkRm9sZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGRpci5uYW1lID0gZGlyZWN0b3J5UmVOYW1lXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIGRpcmVjdG9yeU1vZGFsVGV4dC52YWx1ZSA9IG51bGw7XG4gICAgICAgICAgICBzYXZlQW5kUmVuZGVyTGlzdCgpO1xuICAgICAgICAgICAgZGlyZWN0b3J5TW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG4gICAgICAgICAgICBlZGl0RGlyQnRuLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGVkaXREaXJGb3JtKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNsb3NlRWRpdERpciA9ICgpID0+IHtcbiAgICAgICAgICAgIGRpcmVjdG9yeU1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgZWRpdERpckJ0bi5yZW1vdmVFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBlZGl0RGlyRm9ybSk7XG4gICAgICAgICAgICBjbG9zZUVkaXREaXJCdG4ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZUVkaXREaXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgY2xvc2VFZGl0RGlyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VFZGl0RGlyKTtcbiAgICAgICAgZWRpdERpckJ0bi5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBlZGl0RGlyRm9ybSk7XG4gICAgfVxuICAgIFxuXG59XG5cbi8vY3JlYXRlcyBhIGRpcmVjdG9yeSBmb2xkZXIgb2JqZWN0IHRvIGJlIHB1c2hlZCBpbnRvIGRpcmVjdG9yeSBhcnJheVxuY29uc3QgY3JlYXRlTmV3RGlyID0gKGRpcikgPT4ge1xuICAgcmV0dXJuIHsgaWQ6IERhdGUubm93KCkudG9TdHJpbmcoKSwgbmFtZTogZGlyLCB0YXNrczogW10gfVxufVxuXG5leHBvcnQgeyByZW5kZXJMaXN0cywgY3JlYXRlRGlyTGlzdGVuZXIsIHNhdmVBbmRSZW5kZXJMaXN0LCBkaXJlY3RvcnlBcnIsIHNlbGVjdGVkRm9sZGVyLCBjbGVhckxpc3QgfSIsImltcG9ydCB7IGNyZWF0ZURpckxpc3RlbmVyLCBzYXZlQW5kUmVuZGVyTGlzdCwgcmVuZGVyTGlzdHMsIGRpcmVjdG9yeUFyciwgc2VsZWN0ZWRGb2xkZXIgfSBmcm9tIFwiLi9kaXJlY3RvcnktY3JlYXRvclwiO1xuaW1wb3J0IHsgdG9nZ2xlVGhlbWUgfSBmcm9tIFwiLi90b2dnbGVUaGVtZVwiO1xuaW1wb3J0IHsgcmVuZGVyVGFza3MsIGxpc3RMaXN0ZW5lcnMgfSBmcm9tIFwiLi9saXN0LWNyZWF0b3JcIlxuXG5mdW5jdGlvbiBjcmVhdGVIVE1MRWxlbWVudCh0eXBlLCBpZCwgY2xhc3NlcywgY29udGVudCkge1xuICAgIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHR5cGUpO1xuXG4gICAgaWYoaWQpIGVsZW1lbnQuaWQgPSBpZDtcbiAgICBpZihjbGFzc2VzKSB7XG4gICAgICAgIGNsYXNzZXMuZm9yRWFjaCgobXlDbGFzcykgPT4gZWxlbWVudC5jbGFzc0xpc3QuYWRkKG15Q2xhc3MpKTtcbiAgICB9O1xuICAgIGlmKGNvbnRlbnQpIGVsZW1lbnQudGV4dENvbnRlbnQgPSBjb250ZW50O1xuXG4gICAgcmV0dXJuIGVsZW1lbnQ7XG59O1xuXG5jb25zdCByZW5kZXIgPSAoKSA9PiB7XG4gICAgc2F2ZUFuZFJlbmRlckxpc3QoKTtcbiAgICByZW5kZXJUYXNrcygpO1xufVxuXG5cbnRvZ2dsZVRoZW1lKCk7XG5yZW5kZXIoKTtcbmNyZWF0ZURpckxpc3RlbmVyKCk7XG5saXN0TGlzdGVuZXJzKCk7XG5cbmV4cG9ydCB7XG4gICAgY3JlYXRlSFRNTEVsZW1lbnQsIHJlbmRlclxufSIsImNvbnN0IHRvZ2dsZVRoZW1lID0gKCkgPT4ge1xuXG5jb25zdCB0b2dnbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubGlnaHQtZGFyay1tb2RlJyk7XG50b2dnbGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGVNb2RlKTtcblxuZnVuY3Rpb24gdG9nZ2xlTW9kZSgpIHtcbiAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScpO1xuICAgIHRvZ2dsZS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnKTtcblxuICAgIGNvbnN0IGN1cnJlbnRUaGVtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jdXJyZW50LXRoZW1lJyk7XG5cbiAgICBpZih0b2dnbGUuY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSkgeyBcbiAgICAgICAgY3VycmVudFRoZW1lLnRleHRDb250ZW50ID0gJ0RhcmsgTW9kZSc7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY3VycmVudFRoZW1lLnRleHRDb250ZW50ID0gJ0xpZ2h0IE1vZGUnO1xuICAgIH07XG59XG59XG5cbmV4cG9ydCB7IHRvZ2dsZVRoZW1lIH0iXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsImV4cG9ydHMiLCJkZWZpbml0aW9uIiwia2V5IiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJmb2xkZXJEaXNwbGF5Q29udGFpbmVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZm9sZGVyVGl0bGUiLCJ0YXNrQ291bnQiLCJ0YXNrQ29udGFpbmVyIiwidGFza1RlbXBsYXRlIiwicmVuZGVyVGFza3MiLCJzZWxlY3RlZExpc3QiLCJkaXJlY3RvcnlBcnIiLCJmaW5kIiwibGlzdCIsImlkIiwic2VsZWN0ZWRGb2xkZXIiLCJzdHlsZSIsImRpc3BsYXkiLCJ0ZXh0Q29udGVudCIsIm5hbWUiLCJzZWxlY3RlZFRhc2tOdW0iLCJpbmNvbXBsZXRlIiwidGFza3MiLCJmaWx0ZXIiLCJ0YXNrIiwiY29tcGxldGUiLCJsZW5ndGgiLCJ0YXNrc1N0cmluZyIsInJlbmRlclRhc2tOdW0iLCJjbGVhckxpc3QiLCJmb3JFYWNoIiwidGFza0RPTSIsImltcG9ydE5vZGUiLCJjb250ZW50IiwiY2hlY2tCb3giLCJjaGVja2VkIiwidGFza0Rlc2MiLCJkZXNjIiwidGFza0RhdGUiLCJkYXRlIiwiYXBwZW5kQ2hpbGQiLCJjcmVhdGVUYXNrTW9kYWwiLCJjbGFzc0xpc3QiLCJhZGQiLCJzdWJtaXRGb3JtIiwiZSIsInByZXZlbnREZWZhdWx0IiwibGlzdE1vZGFsIiwidGFza0lucHV0TmFtZSIsInRhc2tJbnB1dERlc2MiLCJ0YXNrSW5wdXREYXRlIiwidGFza05hbWUiLCJ2YWx1ZSIsImNyZWF0ZVRhc2siLCJwdXNoIiwicmVtb3ZlIiwicmVuZGVyIiwiRGF0ZSIsIm5vdyIsInRvU3RyaW5nIiwiTE9DQUxfU1RPUkFHRV9ESVJfS0VZIiwiTE9DQUxfU1RPUkFHRV9GT0xERVJfS0VZIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsIkpTT04iLCJwYXJzZSIsInNhdmVBbmRSZW5kZXJMaXN0Iiwic2F2ZSIsInJlbmRlckxpc3RzIiwic2V0SXRlbSIsInN0cmluZ2lmeSIsImRpcmVjdG9yeUNvbnRhaW5lciIsImRpcmVjdG9yeSIsImRpcmVjdG9yeUZvbGRlciIsImNyZWF0ZUhUTUxFbGVtZW50IiwiZGF0YXNldCIsImxpc3RJZCIsImRpcmVjdG9yeUZvbGRlckljb25zIiwiaW5uZXJIVE1MIiwiY29udGFpbnMiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJjcmVhdGVEaXJlY3RvcnkiLCJkaXJUZXh0IiwiZGlyTmFtZSIsImNyZWF0ZU5ld0RpciIsInNlbGVjdGVkRGlyZWN0b3J5TGlzdGVuZXIiLCJ0YXJnZXQiLCJ0YWdOYW1lIiwidG9Mb3dlckNhc2UiLCJkZWxldGVEaXIiLCJwYXJlbnRFbGVtZW50IiwiZWRpdERpciIsImRpcmVjdG9yeU1vZGFsIiwidG9nZ2xlIiwiZWRpdERpckJ0biIsImNsb3NlRWRpdERpckJ0biIsImNvbnNvbGUiLCJsb2ciLCJlZGl0RGlyRm9ybSIsImRpcmVjdG9yeU1vZGFsVGV4dCIsImRpcmVjdG9yeVJlTmFtZSIsImRpciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJjbG9zZUVkaXREaXIiLCJhZGRFdmVudExpc3RlbmVyIiwidHlwZSIsImNsYXNzZXMiLCJlbGVtZW50IiwiY3JlYXRlRWxlbWVudCIsIm15Q2xhc3MiLCJib2R5IiwiY3VycmVudFRoZW1lIiwidG9nZ2xlVGhlbWUiLCJkaXJGb3JtIiwiZGlyQ29udGFpbmVyIiwiY3JlYXRlRGlyTGlzdGVuZXIiXSwic291cmNlUm9vdCI6IiJ9