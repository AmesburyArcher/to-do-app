(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{N:()=>x,s:()=>b});const t=()=>{document.querySelector(".current-date").textContent=n()};function n(){const e=new Date;let t=1==e.getMinutes().toString().length?"0"+e.getMinutes():e.getMinutes(),n=1==e.getHours().toString().length?"0"+e.getHours():e.getHours(),o=e.getHours()>=12?"pm":"am";return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e.getDay()]+" "+["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()]+" "+e.getDate()+" "+e.getFullYear()+" "+n+":"+t+o}const o=document.querySelector("#to-do-list"),a=document.querySelector(".to-do-title"),s=document.querySelector(".task-count"),r=document.querySelector(".tasks"),c=document.querySelector("#task-template"),l=e=>{const t=e.tasks.filter((e=>!e.complete)).length,n=1===t?"task":"tasks";s.textContent=`${t} ${n} remaining`},i=()=>{const e=g.find((e=>e.id===v));null==e?o.style.display="none":(o.style.display="",a.textContent=e.name,l(e),h(r),e.tasks.forEach((e=>{const t=document.importNode(c.content,!0),n=t.querySelector("input");n.id=e.id,n.checked=e.complete,t.querySelector(".task-name").textContent=e.name;const o=t.querySelector(".task-desc");e.desc?o.textContent=` Description: ${e.desc}`:o.textContent="No Description.";const a=t.querySelector(".task-date");e.date?a.textContent=` Complete by: ${e.date}`:a.textContent="No Completion Date.",t.querySelector(".task-posted").textContent=`Posted on: ${e.posted}`,t.querySelector(".edit-task").innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="edit-task-icon" width="20" height="20" viewBox="0 0 24 24" stroke-width="1.5" stroke="#000000" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" /><line x1="13.5" y1="6.5" x2="17.5" y2="10.5" /></svg>',r.appendChild(t)})))},d=(e,t,n,o)=>({id:Date.now().toString(),name:e,desc:t,date:n,posted:o,complete:!1}),u="task.list",m="task.selectedFolder";let v=localStorage.getItem(m),g=JSON.parse(localStorage.getItem(u))||[];const y=()=>{k(),p()},k=()=>{localStorage.setItem(u,JSON.stringify(g)),localStorage.setItem(m,v)},p=()=>{const e=document.querySelector(".directory");h(e),g.forEach((t=>{const n=x("li",null,["directory-folder"],t.name);n.dataset.listId=t.id,t.id===v&&n.classList.add("directory-active"),e.appendChild(n);const o=x("span",null,["directory-folder-icons"],null);o.innerHTML='<button class="button-edit"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-edit" width="18" height="18" viewBox="0 0 24 24" stroke-width="1.5" stroke="#ffffff" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" /><line x1="13.5" y1="6.5" x2="17.5" y2="10.5" /></svg></button><button class="button-trash"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-trash" width="18" height="18" viewBox="0 0 24 24" stroke-width="1.5" stroke="#ffffff" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="4" y1="7" x2="20" y2="7" /><line x1="10" y1="11" x2="10" y2="17" /><line x1="14" y1="11" x2="14" y2="17" /><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" /><path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" /></svg></button>',n.classList.contains("directory-active")&&n.appendChild(o)}))},h=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)},S=e=>{const t=document.querySelector(".add-dir-btn-text");e.preventDefault();const n=t.value;if(null==n||""===n)return;const o=E(n);t.value=null,g.push(o),y()},f=e=>{"li"===e.target.tagName.toLowerCase()&&(v=e.target.dataset.listId,y(),i())},L=e=>{(e.target.classList.contains("icon-trash")||e.target.classList.contains("button-trash"))&&(e.target.parentElement.parentElement.parentElement.dataset.listId!==v&&e.target.parentElement.parentElement.dataset.listId!==v||(g=g.filter((e=>e.id!==v)),v=null,b()))},q=e=>{if((e.target.classList.contains("icon-edit")||e.target.classList.contains("button-edit"))&&(e.target.parentElement.parentElement.parentElement.dataset.listId===v||e.target.parentElement.parentElement.dataset.listId===v)){const e=document.querySelector(".directory-modal-container");e.classList.toggle("active");const t=document.querySelector("#directory-edit-form"),n=document.querySelector(".icon-tabler-square-x"),o=n=>{n.preventDefault();const a=document.querySelector("#text-dir"),s=a.value;null!=s&&""!==s&&(g.forEach((e=>{e.id===v&&(e.name=s)})),a.value=null,y(),i(),e.classList.remove("active"),t.removeEventListener("submit",o))},a=()=>{e.classList.remove("active"),t.removeEventListener("submit",o),n.removeEventListener("click",a)};n.addEventListener("click",a),t.addEventListener("submit",o)}},E=e=>({id:Date.now().toString(),name:e,tasks:[]});function x(e,t,n,o){const a=document.createElement(e);return t&&(a.id=t),n&&n.forEach((e=>a.classList.add(e))),o&&(a.textContent=o),a}const b=()=>{y(),i()};setInterval(t,1e3),(()=>{const e=document.querySelector(".light-dark-mode");e.addEventListener("click",(function(){t=localStorage.getItem("darkMode"),"enabled"!==t?(localStorage.setItem("darkMode","enabled"),document.body.classList.add("active"),e.classList.add("active")):(localStorage.setItem("darkMode",null),document.body.classList.remove("active"),e.classList.remove("active")),e.classList.contains("active")?n.textContent="Dark Mode":n.textContent="Light Mode"}));let t=localStorage.getItem("darkMode");const n=document.querySelector(".current-theme");"enabled"===t&&(localStorage.setItem("darkMode","enabled"),document.body.classList.add("active"),e.classList.add("active"),n.textContent="Dark Mode")})(),b(),(()=>{const e=document.querySelector("#add-dir-form"),t=document.querySelector(".directory");e.addEventListener("submit",S),t.addEventListener("click",f),t.addEventListener("click",L),t.addEventListener("click",q)})(),document.querySelector(".create-task-btn").addEventListener("click",(()=>{document.querySelector(".modal-container").classList.add("active")})),document.querySelector("#add-task").addEventListener("submit",(e=>{e.preventDefault();const t=document.querySelector(".modal-container"),o=document.querySelector("#task"),a=document.querySelector("#description"),s=document.querySelector("#date"),r=n(),c=o.value;if(null==c||""===c)return;const l=a.value,i=s.value,u=d(c,l,i,r);o.value=null,a.value=null,s.value=null,g.find((e=>e.id===v)).tasks.push(u),t.classList.remove("active"),b()})),r.addEventListener("click",(e=>{if("input"===e.target.tagName.toLowerCase()){const t=g.find((e=>e.id===v));t.tasks.find((t=>t.id===e.target.id)).complete=e.target.checked,k(),l(t)}})),r.addEventListener("click",(e=>{const t=g.find((e=>e.id===v)),n=e.target.parentNode.parentNode,o=Array.from(n.parentNode.children).indexOf(n),a=document.querySelector(".task-edit"),s=document.querySelector(".description-edit"),r=document.querySelector(".date-edit");let c=t.tasks[o];const l=document.querySelector(".modal-container-edit"),d=document.querySelector("#add-task-edit");if(e.target.classList.contains("edit-task-icon")||e.target.classList.contains("edit-task")){a.value=c.name,c.desc?s.value=c.desc:s.value="",c.date?r.value=c.date:r.value="",l.classList.add("active");const e=t=>{console.log(o),t.preventDefault(),c.name=a.value,c.desc=s.value,c.date=r.value,c="",console.log(c),l.classList.remove("active"),d.removeEventListener("submit",e),i(),k()},t=()=>{d.removeEventListener("submit",e),l.classList.remove("active"),n.removeEventListener("click",t)},n=document.querySelector(".close-task-modal-edit");n.addEventListener("click",t),d.addEventListener("submit",e)}})),document.querySelector(".delete-tasks").addEventListener("click",(()=>{const e=g.find((e=>e.id===v));e.tasks=e.tasks.filter((e=>!e.complete)),b()})),document.querySelector(".close-task-modal").addEventListener("click",(()=>{document.querySelector(".modal-container").classList.remove("active")})),t()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Z0MsR0FDM0MxRyxJQUNBaUMsS0FJRTRFLEVBQWdCLEtBQ2xCSixFQUFhL0Isb0JBQW9CLFNBQVVnQyxHQUMzQ0YsRUFBYzdELFVBQVU4QixPQUFPLFVBQy9CcUMsRUFBbUJwQyxvQkFBb0IsUUFBU21DLElBRzlDQyxFQUFxQjVJLFNBQVNDLGNBQWMsMEJBQ2xEMkksRUFBbUJsQyxpQkFBaUIsUUFBU2lDLEdBRTlDSixFQUFhN0IsaUJBQWlCLFNBQVU4QixPQTVHdkJ4SSxTQUFTQyxjQUFjLGlCQUMvQnlHLGlCQUFpQixTQVNMLEtBQ3hCLE1BQU0zRSxFQUFlQyxFQUFhQyxNQUFLQyxHQUFRQSxFQUFLQyxLQUFPQyxJQUMzREwsRUFBYU4sTUFBUU0sRUFBYU4sTUFBTUMsUUFBT0MsSUFBU0EsRUFBS0MsV0FDN0RpRSxPQVRrQjdGLFNBQVNDLGNBQWMscUJBQy9CeUcsaUJBQWlCLFNBNEhSLEtBQ0QxRyxTQUFTQyxjQUFjLG9CQUMvQndFLFVBQVU4QixPQUFPLGFFckkzQnhHLEsiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90by1kby1hcHAvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vdG8tZG8tYXBwL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly90by1kby1hcHAvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly90by1kby1hcHAvLi9zcmMvZGF0ZS5qcyIsIndlYnBhY2s6Ly90by1kby1hcHAvLi9zcmMvbGlzdC1jcmVhdG9yLmpzIiwid2VicGFjazovL3RvLWRvLWFwcC8uL3NyYy9kaXJlY3RvcnktY3JlYXRvci5qcyIsIndlYnBhY2s6Ly90by1kby1hcHAvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vdG8tZG8tYXBwLy4vc3JjL3RvZ2dsZVRoZW1lLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiY29uc3QgZGlzcGxheURhdGUgPSAoKSA9PiB7XG4gICAgY29uc3QgZGF0ZURPTSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jdXJyZW50LWRhdGUnKTtcbiAgICBkYXRlRE9NLnRleHRDb250ZW50ID0gZm9ybWF0QU1QTSgpXG59XG5cblxuLy8gY3JlYXRlcyB0aGUgY3VycmVudCBkYXRlIGF0IHRpbWUgb2YgZXhlY3V0aW9uXG5mdW5jdGlvbiBmb3JtYXRBTVBNKCkge1xuICAgIGNvbnN0IGQgPSBuZXcgRGF0ZSgpXG4gICAgbGV0IG1pbnV0ZXMgPSBkLmdldE1pbnV0ZXMoKS50b1N0cmluZygpLmxlbmd0aCA9PSAxID8gJzAnK2QuZ2V0TWludXRlcygpIDogZC5nZXRNaW51dGVzKCk7XG4gICAgbGV0IGhvdXJzID0gZC5nZXRIb3VycygpLnRvU3RyaW5nKCkubGVuZ3RoID09IDEgPyAnMCcrZC5nZXRIb3VycygpIDogZC5nZXRIb3VycygpO1xuICAgIGxldCBhbXBtID0gZC5nZXRIb3VycygpID49IDEyID8gJ3BtJyA6ICdhbSc7XG4gICAgbGV0IG1vbnRocyA9IFsnSmFuJywnRmViJywnTWFyJywnQXByJywnTWF5JywnSnVuJywnSnVsJywnQXVnJywnU2VwJywnT2N0JywnTm92JywnRGVjJ107XG4gICAgbGV0IGRheXMgPSBbJ1N1bicsJ01vbicsJ1R1ZScsJ1dlZCcsJ1RodScsJ0ZyaScsJ1NhdCddO1xuICAgIHJldHVybiBkYXlzW2QuZ2V0RGF5KCldKycgJyttb250aHNbZC5nZXRNb250aCgpXSsnICcrZC5nZXREYXRlKCkrJyAnK2QuZ2V0RnVsbFllYXIoKSsnICcraG91cnMrJzonK21pbnV0ZXMrYW1wbTtcbiAgICB9XG5cbmV4cG9ydCB7IGRpc3BsYXlEYXRlLCBmb3JtYXRBTVBNIH0iLCJpbXBvcnQgeyByZW5kZXIgfSBmcm9tIFwiLi9pbmRleFwiO1xuaW1wb3J0IHsgZGlyZWN0b3J5QXJyLCBzZWxlY3RlZEZvbGRlciwgY2xlYXJMaXN0LCBzYXZlIH0gZnJvbSBcIi4vZGlyZWN0b3J5LWNyZWF0b3JcIjtcbmltcG9ydCB7IGZvcm1hdEFNUE0gfSBmcm9tIFwiLi9kYXRlXCI7XG5cblxuY29uc3QgZm9sZGVyRGlzcGxheUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0by1kby1saXN0Jyk7XG5jb25zdCBmb2xkZXJUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50by1kby10aXRsZScpO1xuY29uc3QgdGFza0NvdW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRhc2stY291bnQnKTtcbmNvbnN0IHRhc2tDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGFza3MnKTtcbmNvbnN0IHRhc2tUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0YXNrLXRlbXBsYXRlJyk7XG5cbi8vIGNyZWF0ZXMgbGlzdGVuZXJzIGZvciB0YXNrc1xuY29uc3QgbGlzdExpc3RlbmVycyA9ICgpID0+IHtcblxuICAgIC8vIGNyZWF0ZSBuZXcgdGFzayBidXR0b25cbiAgICBjb25zdCBjcmVhdGVUYXNrQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNyZWF0ZS10YXNrLWJ0bicpO1xuICAgIGNyZWF0ZVRhc2tCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjcmVhdGVUYXNrTW9kYWwpXG5cbiAgICAvLyBzdWJtaXQgbmV3IHRhc2sgYnV0dG9uXG4gICAgY29uc3Qgc3VibWl0VGFzayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhZGQtdGFzaycpO1xuICAgIHN1Ym1pdFRhc2suYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0Jywgc3VibWl0Rm9ybSk7XG5cbiAgICAvL2NoZWNrIGlmIGNvbXBsZXRlXG4gICAgdGFza0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRhc2tDaGVjayk7XG5cbiAgICAvL2VkaXQgdGFza1xuICAgIHRhc2tDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlZGl0VGFza0RldGFpbHMpO1xuXG4gICAgLy8gZGVsZXRlIHNlbGVjdGVkIHRhc2tzIGJ1dHRvblxuICAgIGNvbnN0IGRlbGV0ZVRhc2tzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRlbGV0ZS10YXNrcycpO1xuICAgIGRlbGV0ZVRhc2tzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZGVsZXRlU2VsZWN0ZWRUYXNrcylcblxuICAgIC8vIGNsb3NlIHRhc2sgbW9kYWxcbiAgICBjb25zdCBjbG9zZVRhc2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2xvc2UtdGFzay1tb2RhbCcpO1xuICAgIGNsb3NlVGFzay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlVGFza01vZGFsKTtcbiAgICBcbn1cblxuLy8gZGVsZXRlcyBzZWxlY3RlZCB0YXNrc1xuY29uc3QgZGVsZXRlU2VsZWN0ZWRUYXNrcyA9ICgpID0+IHtcbiAgICBjb25zdCBzZWxlY3RlZExpc3QgPSBkaXJlY3RvcnlBcnIuZmluZChsaXN0ID0+IGxpc3QuaWQgPT09IHNlbGVjdGVkRm9sZGVyKTtcbiAgICBzZWxlY3RlZExpc3QudGFza3MgPSBzZWxlY3RlZExpc3QudGFza3MuZmlsdGVyKHRhc2sgPT4gIXRhc2suY29tcGxldGUpO1xuICAgIHJlbmRlcigpO1xufVxuXG4vLyBjaGVja3MgaWYgdGFzayBpcyBtYXJrZWQgY29tcGxldGVcbmNvbnN0IHRhc2tDaGVjayA9IChlKSA9PiB7XG4gICAgaWYoZS50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnaW5wdXQnKSB7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkTGlzdCA9IGRpcmVjdG9yeUFyci5maW5kKGxpc3QgPT4gbGlzdC5pZCA9PT0gc2VsZWN0ZWRGb2xkZXIpO1xuICAgICAgICBjb25zdCBzZWxlY3RlZFRhc2sgPSBzZWxlY3RlZExpc3QudGFza3MuZmluZCh0YXNrID0+IHRhc2suaWQgPT09IGUudGFyZ2V0LmlkKSBcbiAgICAgICAgc2VsZWN0ZWRUYXNrLmNvbXBsZXRlID0gZS50YXJnZXQuY2hlY2tlZDtcbiAgICAgICAgc2F2ZSgpO1xuICAgICAgICByZW5kZXJUYXNrTnVtKHNlbGVjdGVkTGlzdCk7XG4gICAgfVxufVxuXG4vLyByZW5kZXJzIGFuZCBkaXNwbGF5cyB0byBET00gbnVtYmVyIG9mIHRhc2tzIHJlbWFpbmluZyB0byBjb21wbGV0ZVxuY29uc3QgcmVuZGVyVGFza051bSA9IChzZWxlY3RlZFRhc2tOdW0pID0+IHtcbiAgICBjb25zdCBpbmNvbXBsZXRlID0gc2VsZWN0ZWRUYXNrTnVtLnRhc2tzLmZpbHRlcih0YXNrID0+ICF0YXNrLmNvbXBsZXRlKS5sZW5ndGg7XG4gICAgY29uc3QgdGFza3NTdHJpbmcgPSBpbmNvbXBsZXRlID09PSAxID8gXCJ0YXNrXCIgOiBcInRhc2tzXCI7XG4gICAgdGFza0NvdW50LnRleHRDb250ZW50ID0gYCR7aW5jb21wbGV0ZX0gJHt0YXNrc1N0cmluZ30gcmVtYWluaW5nYDtcbn1cblxuLy8gZnVuY3Rpb24gdXNlZCB0byBjcmVhdGUgdGhlIHRhc2sgZWxlbWVudCBmb3IgdGhlIERPTVxuY29uc3QgcmVuZGVyVGFza0xpc3QgPSAoc2VsZWN0ZWRUYXNrTGlzdCkgPT4ge1xuICAgIHNlbGVjdGVkVGFza0xpc3QudGFza3MuZm9yRWFjaCh0YXNrID0+IHtcbiAgICAgICAgY29uc3QgdGFza0RPTSA9IGRvY3VtZW50LmltcG9ydE5vZGUodGFza1RlbXBsYXRlLmNvbnRlbnQsIHRydWUpXG4gICAgICAgIGNvbnN0IGNoZWNrQm94ID0gdGFza0RPTS5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpO1xuICAgICAgICBjaGVja0JveC5pZCA9IHRhc2suaWQ7XG4gICAgICAgIGNoZWNrQm94LmNoZWNrZWQgPSB0YXNrLmNvbXBsZXRlO1xuICAgICAgICBjb25zdCB0YXNrTmFtZSA9ICB0YXNrRE9NLnF1ZXJ5U2VsZWN0b3IoJy50YXNrLW5hbWUnKTtcbiAgICAgICAgdGFza05hbWUudGV4dENvbnRlbnQgPSB0YXNrLm5hbWU7XG5cbiAgICAgICAgY29uc3QgdGFza0Rlc2MgPSB0YXNrRE9NLnF1ZXJ5U2VsZWN0b3IoJy50YXNrLWRlc2MnKVxuICAgICAgICB0YXNrLmRlc2MgPyB0YXNrRGVzYy50ZXh0Q29udGVudCA9IGAgRGVzY3JpcHRpb246ICR7dGFzay5kZXNjfWAgOiB0YXNrRGVzYy50ZXh0Q29udGVudCA9ICdObyBEZXNjcmlwdGlvbi4nO1xuICAgICAgIFxuICAgICAgICBjb25zdCB0YXNrRGF0ZSA9IHRhc2tET00ucXVlcnlTZWxlY3RvcignLnRhc2stZGF0ZScpO1xuICAgICAgICB0YXNrLmRhdGUgPyB0YXNrRGF0ZS50ZXh0Q29udGVudCA9IGAgQ29tcGxldGUgYnk6ICR7dGFzay5kYXRlfWAgOiB0YXNrRGF0ZS50ZXh0Q29udGVudCA9ICdObyBDb21wbGV0aW9uIERhdGUuJztcblxuICAgICAgICBjb25zdCB0YXNrUG9zdGVkID0gdGFza0RPTS5xdWVyeVNlbGVjdG9yKCcudGFzay1wb3N0ZWQnKTtcbiAgICAgICAgdGFza1Bvc3RlZC50ZXh0Q29udGVudCA9IGBQb3N0ZWQgb246ICR7dGFzay5wb3N0ZWR9YDtcblxuICAgICAgICBjb25zdCBlZGl0VGFzayA9IHRhc2tET00ucXVlcnlTZWxlY3RvcignLmVkaXQtdGFzaycpO1xuICAgICAgICBlZGl0VGFzay5pbm5lckhUTUwgPSAnPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgY2xhc3M9XCJlZGl0LXRhc2staWNvblwiIHdpZHRoPVwiMjBcIiBoZWlnaHQ9XCIyMFwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBzdHJva2Utd2lkdGg9XCIxLjVcIiBzdHJva2U9XCIjMDAwMDAwXCIgZmlsbD1cIm5vbmVcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj48cGF0aCBzdHJva2U9XCJub25lXCIgZD1cIk0wIDBoMjR2MjRIMHpcIiBmaWxsPVwibm9uZVwiLz48cGF0aCBkPVwiTTQgMjBoNGwxMC41IC0xMC41YTEuNSAxLjUgMCAwIDAgLTQgLTRsLTEwLjUgMTAuNXY0XCIgLz48bGluZSB4MT1cIjEzLjVcIiB5MT1cIjYuNVwiIHgyPVwiMTcuNVwiIHkyPVwiMTAuNVwiIC8+PC9zdmc+J1xuXG4gICAgICAgIHRhc2tDb250YWluZXIuYXBwZW5kQ2hpbGQodGFza0RPTSk7XG4gICAgfSlcbiAgICBcbn1cblxuLy8gZnVuY3Rpb24gdG8gZWRpdCB0YXNrIGRldGFpbHNcbmNvbnN0IGVkaXRUYXNrRGV0YWlscyA9IChlKSA9PiB7XG5cbiAgICBjb25zdCBzZWxlY3RlZExpc3QgPSBkaXJlY3RvcnlBcnIuZmluZChsaXN0ID0+IGxpc3QuaWQgPT09IHNlbGVjdGVkRm9sZGVyKTsgXG4gICAgY29uc3Qgc2VsZWN0ZWRFbGVtZW50ID0gZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlO1xuICAgIGNvbnN0IHNlbGVjdGVkVGFzayA9IEFycmF5LmZyb20oc2VsZWN0ZWRFbGVtZW50LnBhcmVudE5vZGUuY2hpbGRyZW4pLmluZGV4T2Yoc2VsZWN0ZWRFbGVtZW50KVxuXG4gICAgY29uc3QgdGFza0lucHV0TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50YXNrLWVkaXQnKTtcbiAgICBjb25zdCB0YXNrSW5wdXREZXNjID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uLWVkaXQnKTtcbiAgICBjb25zdCB0YXNrSW5wdXREYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRhdGUtZWRpdCcpO1xuXG4gICAgbGV0IGl0ZW1zID0gc2VsZWN0ZWRMaXN0LnRhc2tzW3NlbGVjdGVkVGFza107XG4gICAgY29uc3QgdGFza0VkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1jb250YWluZXItZWRpdCcpO1xuICAgIGNvbnN0IHRhc2tFZGl0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhZGQtdGFzay1lZGl0Jyk7XG5cbiAgICBpZihlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2VkaXQtdGFzay1pY29uJykgfHwgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdlZGl0LXRhc2snKSkge1xuICAgICAgIHRhc2tJbnB1dE5hbWUudmFsdWUgPSBpdGVtcy5uYW1lO1xuICAgICAgIGl0ZW1zLmRlc2MgPyB0YXNrSW5wdXREZXNjLnZhbHVlID0gaXRlbXMuZGVzYyA6IHRhc2tJbnB1dERlc2MudmFsdWUgPSAnJztcbiAgICAgICBpdGVtcy5kYXRlID8gdGFza0lucHV0RGF0ZS52YWx1ZSA9IGl0ZW1zLmRhdGUgOiB0YXNrSW5wdXREYXRlLnZhbHVlID0gJyc7XG4gICAgICAgXG4gICAgICAgdGFza0VkaXRNb2RhbC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcbiAgICAgICBcbiAgICAgICAvLyBmdW5jdGlvbiB0byBzdWJtaXQgdGFzayBlZGl0IGZvcm1cbiAgICAgICAgY29uc3Qgc3VibWl0VGFza0VkaXQgPSAoZSkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coc2VsZWN0ZWRUYXNrKVxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgaXRlbXMubmFtZSA9IHRhc2tJbnB1dE5hbWUudmFsdWU7XG4gICAgICAgICAgICBpdGVtcy5kZXNjID0gdGFza0lucHV0RGVzYy52YWx1ZTtcbiAgICAgICAgICAgIGl0ZW1zLmRhdGUgPSB0YXNrSW5wdXREYXRlLnZhbHVlO1xuICAgICAgICAgICAgaXRlbXMgPSAnJztcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGl0ZW1zKTtcbiAgICAgICAgICAgIHRhc2tFZGl0TW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG4gICAgICAgICAgICB0YXNrRWRpdEZvcm0ucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3VibWl0Jywgc3VibWl0VGFza0VkaXQpO1xuICAgICAgICAgICAgcmVuZGVyVGFza3MoKTtcbiAgICAgICAgICAgIHNhdmUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGZ1bmN0aW9uIHRvIGNsb3NlIHRhc2sgZWRpdCBtb2RhbFxuICAgICAgICBjb25zdCBjbG9zZUVkaXRUYXNrID0gKCkgPT4ge1xuICAgICAgICAgICAgdGFza0VkaXRGb3JtLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHN1Ym1pdFRhc2tFZGl0KTtcbiAgICAgICAgICAgIHRhc2tFZGl0TW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG4gICAgICAgICAgICBjbG9zZUVkaXRUYXNrTW9kYWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZUVkaXRUYXNrKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNsb3NlRWRpdFRhc2tNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jbG9zZS10YXNrLW1vZGFsLWVkaXQnKTtcbiAgICAgICAgY2xvc2VFZGl0VGFza01vZGFsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VFZGl0VGFzaylcblxuICAgICAgIHRhc2tFZGl0Rm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBzdWJtaXRUYXNrRWRpdClcbiAgICB9XG5cbn1cblxuLy8gcmVuZGVycyB0aGUgdGFza3MgZnJvbSB0aGUgc2VsZWN0ZWQgZm9sZGVyIG9uIHRoZSBzY3JlZW5cbmNvbnN0IHJlbmRlclRhc2tzID0gKCkgPT4ge1xuICAgIGNvbnN0IHNlbGVjdGVkTGlzdCA9IGRpcmVjdG9yeUFyci5maW5kKGxpc3QgPT4gbGlzdC5pZCA9PT0gc2VsZWN0ZWRGb2xkZXIpO1xuXG4gICAgaWYoc2VsZWN0ZWRMaXN0ID09IG51bGwpIHtcbiAgICAgICAgZm9sZGVyRGlzcGxheUNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGZvbGRlckRpc3BsYXlDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgICAgICBmb2xkZXJUaXRsZS50ZXh0Q29udGVudCA9IHNlbGVjdGVkTGlzdC5uYW1lO1xuICAgICAgICByZW5kZXJUYXNrTnVtKHNlbGVjdGVkTGlzdCk7XG4gICAgICAgIGNsZWFyTGlzdCh0YXNrQ29udGFpbmVyKTtcbiAgICAgICAgcmVuZGVyVGFza0xpc3Qoc2VsZWN0ZWRMaXN0KTtcbiAgICB9XG59XG5cbi8vIGNsb3NlcyB0aGUgdGFzayBtb2RhbCB3aXRoIGNsaWNrIG9mIGJ1dHRvblxuY29uc3QgY2xvc2VUYXNrTW9kYWwgPSAoKSA9PiB7XG4gICAgY29uc3QgbGlzdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWNvbnRhaW5lcicpXG4gICAgbGlzdE1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xufVxuXG4vLyBmdW5jdGlvbiB0aGF0IGRpc3BsYXlzIG1vZGFsIHRvIGFkZCBuZXcgdGFza1xuY29uc3QgY3JlYXRlVGFza01vZGFsID0gKCkgPT4ge1xuICAgIGNvbnN0IGxpc3RNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1jb250YWluZXInKVxuICAgIGxpc3RNb2RhbC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcbn1cblxuLy8gZnVuY3Rpb24gdGhhdCBwcm9jZXNzZXMgdGhlIGlucHV0IGZyb20gdGhlIGNyZWF0ZSB0YXNrIG1vZGFsIGFuZCBzdWJtaXRzIGl0IGZvciBzdG9yYWdlIGFuZCBkaXNwbGF5XG5jb25zdCBzdWJtaXRGb3JtID0gKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgbGlzdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWNvbnRhaW5lcicpXG4gICAgY29uc3QgdGFza0lucHV0TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0YXNrJyk7XG4gICAgY29uc3QgdGFza0lucHV0RGVzYyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNkZXNjcmlwdGlvbicpO1xuICAgIGNvbnN0IHRhc2tJbnB1dERhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZGF0ZScpO1xuICAgIGNvbnN0IHRhc2tQb3N0ZWQgPSBmb3JtYXRBTVBNKCk7XG4gICAgXG4gICAgY29uc3QgdGFza05hbWUgPSB0YXNrSW5wdXROYW1lLnZhbHVlO1xuICAgIGlmKHRhc2tOYW1lID09IG51bGwgfHwgdGFza05hbWUgPT09ICcnKSByZXR1cm47XG4gICAgY29uc3QgdGFza0Rlc2MgPSB0YXNrSW5wdXREZXNjLnZhbHVlO1xuICAgIGNvbnN0IHRhc2tEYXRlID0gdGFza0lucHV0RGF0ZS52YWx1ZVxuICAgIGNvbnN0IHRhc2sgPSBjcmVhdGVUYXNrKHRhc2tOYW1lLCB0YXNrRGVzYywgdGFza0RhdGUsIHRhc2tQb3N0ZWQpO1xuICAgIHRhc2tJbnB1dE5hbWUudmFsdWUgPSBudWxsO1xuICAgIHRhc2tJbnB1dERlc2MudmFsdWUgPSBudWxsO1xuICAgIHRhc2tJbnB1dERhdGUudmFsdWUgPSBudWxsO1xuICAgIGNvbnN0IHNlbGVjdGVkTGlzdCA9IGRpcmVjdG9yeUFyci5maW5kKGxpc3QgPT4gbGlzdC5pZCA9PT0gc2VsZWN0ZWRGb2xkZXIpO1xuICAgIHNlbGVjdGVkTGlzdC50YXNrcy5wdXNoKHRhc2spO1xuICAgIGxpc3RNb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgICByZW5kZXIoKTtcbn1cblxuLy8gdGhpcyBmdW5jdGlvbiBjcmVhdGVzIHRoZSB0YXNrIG9iamVjdCB0byBiZSBwdXNoZWQgaW50byB0aGUgZGlyZWN0b3J5QXJyLnRhc2tzIGFycmF5XG5jb25zdCBjcmVhdGVUYXNrID0gKHRhc2ssIGRlc2MsIGRhdGUsIHBvc3RlZCkgPT4ge1xuICAgIHJldHVybiB7ICBpZDogRGF0ZS5ub3coKS50b1N0cmluZygpLCBuYW1lOiB0YXNrLCBkZXNjOiBkZXNjLCBkYXRlOiBkYXRlLCBwb3N0ZWQ6IHBvc3RlZCwgY29tcGxldGU6IGZhbHNlLCAgfVxufVxuXG5cbmV4cG9ydCB7IHJlbmRlclRhc2tzLCBsaXN0TGlzdGVuZXJzIH0iLCJpbXBvcnQgeyBjcmVhdGVIVE1MRWxlbWVudCwgcmVuZGVyIH0gZnJvbSBcIi4vaW5kZXhcIjtcbmltcG9ydCB7IHJlbmRlclRhc2tzIH0gZnJvbSBcIi4vbGlzdC1jcmVhdG9yXCI7XG5cbmNvbnN0IExPQ0FMX1NUT1JBR0VfRElSX0tFWSA9ICd0YXNrLmxpc3QnO1xuY29uc3QgTE9DQUxfU1RPUkFHRV9GT0xERVJfS0VZID0gJ3Rhc2suc2VsZWN0ZWRGb2xkZXInO1xuXG4vL2xvY2FsIHN0b3JhZ2Uga2V5cyArIGFycmF5XG5sZXQgc2VsZWN0ZWRGb2xkZXIgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShMT0NBTF9TVE9SQUdFX0ZPTERFUl9LRVkpXG5sZXQgZGlyZWN0b3J5QXJyID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShMT0NBTF9TVE9SQUdFX0RJUl9LRVkpKSB8fCBbXTsgXG5cbmNvbnN0IHNhdmVBbmRSZW5kZXJMaXN0ID0gKCkgPT4ge1xuICAgIHNhdmUoKTtcbiAgICByZW5kZXJMaXN0cygpO1xufVxuXG4vL3NhdmVzIHRvIGxvY2FsIHN0b3JhZ2VcbmNvbnN0IHNhdmUgPSAoKSA9PiB7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oTE9DQUxfU1RPUkFHRV9ESVJfS0VZLCBKU09OLnN0cmluZ2lmeShkaXJlY3RvcnlBcnIpKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShMT0NBTF9TVE9SQUdFX0ZPTERFUl9LRVksIHNlbGVjdGVkRm9sZGVyKTtcbn1cblxuLy9yZW5kZXJzIHRoZSBkaXJlY3RvcnkgbGlzdFxuY29uc3QgcmVuZGVyTGlzdHMgPSAoKSA9PiB7XG4gICAgY29uc3QgZGlyZWN0b3J5Q29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRpcmVjdG9yeScpO1xuXG4gICAgY2xlYXJMaXN0KGRpcmVjdG9yeUNvbnRhaW5lcik7XG4gICAgZGlyZWN0b3J5QXJyLmZvckVhY2goZGlyZWN0b3J5ID0+IHtcbiAgICAgICBjb25zdCBkaXJlY3RvcnlGb2xkZXIgPSBjcmVhdGVIVE1MRWxlbWVudCgnbGknLCBudWxsLCBbJ2RpcmVjdG9yeS1mb2xkZXInXSwgZGlyZWN0b3J5Lm5hbWUpXG4gICAgICAgZGlyZWN0b3J5Rm9sZGVyLmRhdGFzZXQubGlzdElkID0gZGlyZWN0b3J5LmlkO1xuICAgICAgIC8vaWYgdGhlIGZvbGRlciBpcyBzZWxlY3RlZCwgbWFrZSBpdCBhY3RpdmUgZm9sZGVyXG4gICAgICAgaWYoZGlyZWN0b3J5LmlkID09PSBzZWxlY3RlZEZvbGRlcikge1xuICAgICAgICAgICBkaXJlY3RvcnlGb2xkZXIuY2xhc3NMaXN0LmFkZCgnZGlyZWN0b3J5LWFjdGl2ZScpO1xuICAgICAgIH1cbiAgICAgICBkaXJlY3RvcnlDb250YWluZXIuYXBwZW5kQ2hpbGQoZGlyZWN0b3J5Rm9sZGVyKTsgXG5cbiAgICAgICBjb25zdCBkaXJlY3RvcnlGb2xkZXJJY29ucyA9IGNyZWF0ZUhUTUxFbGVtZW50KCdzcGFuJywgbnVsbCwgWydkaXJlY3RvcnktZm9sZGVyLWljb25zJ10sIG51bGwpO1xuICAgICAgIGRpcmVjdG9yeUZvbGRlckljb25zLmlubmVySFRNTCA9ICc8YnV0dG9uIGNsYXNzPVwiYnV0dG9uLWVkaXRcIj48c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBjbGFzcz1cImljb24gaWNvbi1lZGl0XCIgd2lkdGg9XCIxOFwiIGhlaWdodD1cIjE4XCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHN0cm9rZS13aWR0aD1cIjEuNVwiIHN0cm9rZT1cIiNmZmZmZmZcIiBmaWxsPVwibm9uZVwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPjxwYXRoIHN0cm9rZT1cIm5vbmVcIiBkPVwiTTAgMGgyNHYyNEgwelwiIGZpbGw9XCJub25lXCIvPjxwYXRoIGQ9XCJNNCAyMGg0bDEwLjUgLTEwLjVhMS41IDEuNSAwIDAgMCAtNCAtNGwtMTAuNSAxMC41djRcIiAvPjxsaW5lIHgxPVwiMTMuNVwiIHkxPVwiNi41XCIgeDI9XCIxNy41XCIgeTI9XCIxMC41XCIgLz48L3N2Zz48L2J1dHRvbj48YnV0dG9uIGNsYXNzPVwiYnV0dG9uLXRyYXNoXCI+PHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgY2xhc3M9XCJpY29uIGljb24tdHJhc2hcIiB3aWR0aD1cIjE4XCIgaGVpZ2h0PVwiMThcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgc3Ryb2tlLXdpZHRoPVwiMS41XCIgc3Ryb2tlPVwiI2ZmZmZmZlwiIGZpbGw9XCJub25lXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+PHBhdGggc3Ryb2tlPVwibm9uZVwiIGQ9XCJNMCAwaDI0djI0SDB6XCIgZmlsbD1cIm5vbmVcIi8+PGxpbmUgeDE9XCI0XCIgeTE9XCI3XCIgeDI9XCIyMFwiIHkyPVwiN1wiIC8+PGxpbmUgeDE9XCIxMFwiIHkxPVwiMTFcIiB4Mj1cIjEwXCIgeTI9XCIxN1wiIC8+PGxpbmUgeDE9XCIxNFwiIHkxPVwiMTFcIiB4Mj1cIjE0XCIgeTI9XCIxN1wiIC8+PHBhdGggZD1cIk01IDdsMSAxMmEyIDIgMCAwIDAgMiAyaDhhMiAyIDAgMCAwIDIgLTJsMSAtMTJcIiAvPjxwYXRoIGQ9XCJNOSA3di0zYTEgMSAwIDAgMSAxIC0xaDRhMSAxIDAgMCAxIDEgMXYzXCIgLz48L3N2Zz48L2J1dHRvbj4nO1xuICAgICAgIC8vaWYgdGhlIGZvbGRlciBpcyBzZWxlY3RlZCwgYWRkIHRoZSBpY29uc1xuICAgICAgIGlmKGRpcmVjdG9yeUZvbGRlci5jbGFzc0xpc3QuY29udGFpbnMoJ2RpcmVjdG9yeS1hY3RpdmUnKSkge1xuICAgICAgIGRpcmVjdG9yeUZvbGRlci5hcHBlbmRDaGlsZChkaXJlY3RvcnlGb2xkZXJJY29ucyk7XG4gICAgICAgfVxuICAgIH0pXG59O1xuXG4vL2NsZWFycyB0aGUgZGlyZWN0b3J5IGxpc3QgdG8gYmUgcmUtcmVuZGVyZWQgaW4gcmVuZGVyTGlzdHNcbmNvbnN0IGNsZWFyTGlzdCA9IChsaXN0KSA9PiB7XG4gICAgd2hpbGUobGlzdC5maXJzdENoaWxkKSB7XG4gICAgICAgIGxpc3QucmVtb3ZlQ2hpbGQobGlzdC5maXJzdENoaWxkKVxuICAgIH1cbn07XG5cbi8vYWRkcyBldmVudGxpc3RlbmVycyBmb3IgdGhlIGRpcmVjdG9yeVxuY29uc3QgY3JlYXRlRGlyTGlzdGVuZXIgPSAoKSA9PiB7XG4gICAgY29uc3QgZGlyRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhZGQtZGlyLWZvcm0nKTtcbiAgICBjb25zdCBkaXJDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZGlyZWN0b3J5Jyk7XG5cbiAgICBkaXJGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGNyZWF0ZURpcmVjdG9yeSlcbiAgICBkaXJDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzZWxlY3RlZERpcmVjdG9yeUxpc3RlbmVyKVxuICAgIGRpckNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGRlbGV0ZURpcilcbiAgICBkaXJDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlZGl0RGlyKVxufVxuXG4vL2NyZWF0ZXMgYSBuZXcgZGlyZWN0b3J5IGZvbGRlclxuY29uc3QgY3JlYXRlRGlyZWN0b3J5ID0gKGUpID0+IHtcbiAgICBjb25zdCBkaXJUZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZC1kaXItYnRuLXRleHQnKTtcblxuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCBkaXJOYW1lID0gZGlyVGV4dC52YWx1ZTtcbiAgICBpZihkaXJOYW1lID09IG51bGwgfHwgZGlyTmFtZSA9PT0gJycpIHJldHVybjtcbiAgICBjb25zdCBkaXJlY3RvcnkgPSBjcmVhdGVOZXdEaXIoZGlyTmFtZSk7XG4gICAgZGlyVGV4dC52YWx1ZSA9IG51bGw7XG4gICAgZGlyZWN0b3J5QXJyLnB1c2goZGlyZWN0b3J5KTtcbiAgICBzYXZlQW5kUmVuZGVyTGlzdCgpO1xufVxuXG4vL2Z1bmN0aW9uIGZvciB0aGUgc2VsZWN0ZWQgZGlyZWN0b3J5IGxpc3RlbmVyXG5jb25zdCBzZWxlY3RlZERpcmVjdG9yeUxpc3RlbmVyID0gKGUpID0+IHtcbiAgICBpZihlLnRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdsaScpIHtcbiAgICAgICAgc2VsZWN0ZWRGb2xkZXIgPSBlLnRhcmdldC5kYXRhc2V0Lmxpc3RJZDtcbiAgICAgICAgc2F2ZUFuZFJlbmRlckxpc3QoKTtcbiAgICAgICAgcmVuZGVyVGFza3MoKTtcbiAgICB9XG59XG5cbi8vZnVuY3Rpb24gZm9yIHRoZSBkZWxldGVkaXIgbGlzdGVuZXIgXG5jb25zdCBkZWxldGVEaXIgPSAoZSkgPT4ge1xuICAgIGlmKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnaWNvbi10cmFzaCcpIHx8IGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnYnV0dG9uLXRyYXNoJykpIHtcbiAgICAgICAgaWYoZS50YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuZGF0YXNldC5saXN0SWQgPT09IHNlbGVjdGVkRm9sZGVyIHx8IGUudGFyZ2V0LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5kYXRhc2V0Lmxpc3RJZCA9PT0gc2VsZWN0ZWRGb2xkZXIpIHtcbiAgICAgICAgZGlyZWN0b3J5QXJyID0gZGlyZWN0b3J5QXJyLmZpbHRlcihkaXJlY3RvcnkgPT4gZGlyZWN0b3J5LmlkICE9PSBzZWxlY3RlZEZvbGRlcik7XG4gICAgICAgIHNlbGVjdGVkRm9sZGVyID0gbnVsbDtcbiAgICAgICAgcmVuZGVyKCk7XG4gICAgICAgIH1cbiAgICB9XG59XG4vL0VkaXRpbmcgdGhlIGRpcmVjdG9yeSBmb2xkZXIgdGl0bGUgYW5kIHVwZGF0aW5nIHRoZSBhcnJheSArIERPTVxuY29uc3QgZWRpdERpciA9IChlKSA9PiB7XG4gICAgaWYoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdpY29uLWVkaXQnKSB8fCBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2J1dHRvbi1lZGl0JykpIHtcbiAgICAgICAgaWYoZS50YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuZGF0YXNldC5saXN0SWQgPT09IHNlbGVjdGVkRm9sZGVyIHx8IGUudGFyZ2V0LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5kYXRhc2V0Lmxpc3RJZCA9PT0gc2VsZWN0ZWRGb2xkZXIpIHtcbiAgICAgICAgY29uc3QgZGlyZWN0b3J5TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZGlyZWN0b3J5LW1vZGFsLWNvbnRhaW5lcicpO1xuICAgICAgICBkaXJlY3RvcnlNb2RhbC5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnKTtcbiAgICAgICAgY29uc3QgZWRpdERpckJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNkaXJlY3RvcnktZWRpdC1mb3JtJyk7XG4gICAgICAgIGNvbnN0IGNsb3NlRWRpdERpckJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5pY29uLXRhYmxlci1zcXVhcmUteCcpO1xuXG4gICAgICAgIGNvbnN0IGVkaXREaXJGb3JtID0gKGUpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGNvbnN0IGRpcmVjdG9yeU1vZGFsVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0ZXh0LWRpcicpO1xuICAgICAgICAgICAgY29uc3QgZGlyZWN0b3J5UmVOYW1lID0gZGlyZWN0b3J5TW9kYWxUZXh0LnZhbHVlO1xuICAgICAgICAgICAgaWYoZGlyZWN0b3J5UmVOYW1lID09IG51bGwgfHwgZGlyZWN0b3J5UmVOYW1lID09PSAnJykgcmV0dXJuO1xuICAgICAgICAgICAgZGlyZWN0b3J5QXJyLmZvckVhY2goZGlyID0+IHtcbiAgICAgICAgICAgICAgICBpZihkaXIuaWQgPT09IHNlbGVjdGVkRm9sZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGRpci5uYW1lID0gZGlyZWN0b3J5UmVOYW1lXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIGRpcmVjdG9yeU1vZGFsVGV4dC52YWx1ZSA9IG51bGw7XG4gICAgICAgICAgICBzYXZlQW5kUmVuZGVyTGlzdCgpO1xuICAgICAgICAgICAgcmVuZGVyVGFza3MoKTtcbiAgICAgICAgICAgIGRpcmVjdG9yeU1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgZWRpdERpckJ0bi5yZW1vdmVFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBlZGl0RGlyRm9ybSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjbG9zZUVkaXREaXIgPSAoKSA9PiB7XG4gICAgICAgICAgICBkaXJlY3RvcnlNb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgICAgICAgICAgIGVkaXREaXJCdG4ucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZWRpdERpckZvcm0pO1xuICAgICAgICAgICAgY2xvc2VFZGl0RGlyQnRuLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VFZGl0RGlyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNsb3NlRWRpdERpckJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlRWRpdERpcik7XG4gICAgICAgIGVkaXREaXJCdG4uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgZWRpdERpckZvcm0pO1xuICAgIH1cbiAgICB9XG4gICAgXG5cbn1cblxuLy9jcmVhdGVzIGEgZGlyZWN0b3J5IGZvbGRlciBvYmplY3QgdG8gYmUgcHVzaGVkIGludG8gZGlyZWN0b3J5IGFycmF5XG5jb25zdCBjcmVhdGVOZXdEaXIgPSAoZGlyKSA9PiB7XG4gICByZXR1cm4geyBpZDogRGF0ZS5ub3coKS50b1N0cmluZygpLCBuYW1lOiBkaXIsIHRhc2tzOiBbXSB9XG59XG5cbmV4cG9ydCB7IHJlbmRlckxpc3RzLCBjcmVhdGVEaXJMaXN0ZW5lciwgc2F2ZUFuZFJlbmRlckxpc3QsIGRpcmVjdG9yeUFyciwgc2VsZWN0ZWRGb2xkZXIsIGNsZWFyTGlzdCwgc2F2ZSB9IiwiaW1wb3J0IHsgY3JlYXRlRGlyTGlzdGVuZXIsIHNhdmVBbmRSZW5kZXJMaXN0fSBmcm9tIFwiLi9kaXJlY3RvcnktY3JlYXRvclwiO1xuaW1wb3J0IHsgdG9nZ2xlVGhlbWUgfSBmcm9tIFwiLi90b2dnbGVUaGVtZVwiO1xuaW1wb3J0IHsgcmVuZGVyVGFza3MsIGxpc3RMaXN0ZW5lcnMgfSBmcm9tIFwiLi9saXN0LWNyZWF0b3JcIlxuaW1wb3J0IHsgZGlzcGxheURhdGUgfSBmcm9tIFwiLi9kYXRlXCI7XG5cbmZ1bmN0aW9uIGNyZWF0ZUhUTUxFbGVtZW50KHR5cGUsIGlkLCBjbGFzc2VzLCBjb250ZW50KSB7XG4gICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodHlwZSk7XG5cbiAgICBpZihpZCkgZWxlbWVudC5pZCA9IGlkO1xuICAgIGlmKGNsYXNzZXMpIHtcbiAgICAgICAgY2xhc3Nlcy5mb3JFYWNoKChteUNsYXNzKSA9PiBlbGVtZW50LmNsYXNzTGlzdC5hZGQobXlDbGFzcykpO1xuICAgIH1cbiAgICBpZihjb250ZW50KSBlbGVtZW50LnRleHRDb250ZW50ID0gY29udGVudDtcblxuICAgIHJldHVybiBlbGVtZW50O1xufVxuXG5jb25zdCByZW5kZXIgPSAoKSA9PiB7XG4gICAgc2F2ZUFuZFJlbmRlckxpc3QoKTtcbiAgICByZW5kZXJUYXNrcygpO1xufVxuXG5jb25zdCBvbkxvYWQgPSAoKSA9PiB7XG4gICAgdG9nZ2xlVGhlbWUoKTtcbiAgICByZW5kZXIoKTtcbiAgICBjcmVhdGVEaXJMaXN0ZW5lcigpO1xuICAgIGxpc3RMaXN0ZW5lcnMoKTsgXG4gICAgZGlzcGxheURhdGUoKTtcbiAgICB0aW1lO1xufVxuXG5jb25zdCB0aW1lID0gc2V0SW50ZXJ2YWwoZGlzcGxheURhdGUsIDEwMDApO1xuXG5vbkxvYWQoKTtcblxuZXhwb3J0IHtcbiAgICBjcmVhdGVIVE1MRWxlbWVudCwgcmVuZGVyXG59IiwiY29uc3QgdG9nZ2xlVGhlbWUgPSAoKSA9PiB7XG5cbmNvbnN0IHRvZ2dsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5saWdodC1kYXJrLW1vZGUnKTtcbnRvZ2dsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZU1vZGUpO1xuXG5sZXQgZGFya01vZGUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZGFya01vZGUnKTtcbmNvbnN0IGN1cnJlbnRUaGVtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jdXJyZW50LXRoZW1lJyk7XG5cbmlmKGRhcmtNb2RlID09PSAnZW5hYmxlZCcpIHtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZGFya01vZGUnLCAnZW5hYmxlZCcpXG4gICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcbiAgICB0b2dnbGUuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gICAgY3VycmVudFRoZW1lLnRleHRDb250ZW50ID0gJ0RhcmsgTW9kZSdcbn1cblxuZnVuY3Rpb24gdG9nZ2xlTW9kZSgpIHtcbiAgICBkYXJrTW9kZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdkYXJrTW9kZScpXG4gICAgaWYoZGFya01vZGUgIT09ICdlbmFibGVkJykge1xuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZGFya01vZGUnLCAnZW5hYmxlZCcpXG4gICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gICAgICAgIHRvZ2dsZS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZGFya01vZGUnLCBudWxsKVxuICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgICAgICB0b2dnbGUuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG4gICAgfVxuXG4gICAgaWYodG9nZ2xlLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykpIHsgXG4gICAgICAgIGN1cnJlbnRUaGVtZS50ZXh0Q29udGVudCA9ICdEYXJrIE1vZGUnO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGN1cnJlbnRUaGVtZS50ZXh0Q29udGVudCA9ICdMaWdodCBNb2RlJztcbiAgICB9XG59XG59XG5cbmV4cG9ydCB7IHRvZ2dsZVRoZW1lIH0iXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsImV4cG9ydHMiLCJkZWZpbml0aW9uIiwia2V5IiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJkaXNwbGF5RGF0ZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInRleHRDb250ZW50IiwiZm9ybWF0QU1QTSIsImQiLCJEYXRlIiwibWludXRlcyIsImdldE1pbnV0ZXMiLCJ0b1N0cmluZyIsImxlbmd0aCIsImhvdXJzIiwiZ2V0SG91cnMiLCJhbXBtIiwiZ2V0RGF5IiwiZ2V0TW9udGgiLCJnZXREYXRlIiwiZ2V0RnVsbFllYXIiLCJmb2xkZXJEaXNwbGF5Q29udGFpbmVyIiwiZm9sZGVyVGl0bGUiLCJ0YXNrQ291bnQiLCJ0YXNrQ29udGFpbmVyIiwidGFza1RlbXBsYXRlIiwicmVuZGVyVGFza051bSIsInNlbGVjdGVkVGFza051bSIsImluY29tcGxldGUiLCJ0YXNrcyIsImZpbHRlciIsInRhc2siLCJjb21wbGV0ZSIsInRhc2tzU3RyaW5nIiwicmVuZGVyVGFza3MiLCJzZWxlY3RlZExpc3QiLCJkaXJlY3RvcnlBcnIiLCJmaW5kIiwibGlzdCIsImlkIiwic2VsZWN0ZWRGb2xkZXIiLCJzdHlsZSIsImRpc3BsYXkiLCJuYW1lIiwiY2xlYXJMaXN0IiwiZm9yRWFjaCIsInRhc2tET00iLCJpbXBvcnROb2RlIiwiY29udGVudCIsImNoZWNrQm94IiwiY2hlY2tlZCIsInRhc2tEZXNjIiwiZGVzYyIsInRhc2tEYXRlIiwiZGF0ZSIsInBvc3RlZCIsImlubmVySFRNTCIsImFwcGVuZENoaWxkIiwiY3JlYXRlVGFzayIsIm5vdyIsIkxPQ0FMX1NUT1JBR0VfRElSX0tFWSIsIkxPQ0FMX1NUT1JBR0VfRk9MREVSX0tFWSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJKU09OIiwicGFyc2UiLCJzYXZlQW5kUmVuZGVyTGlzdCIsInNhdmUiLCJyZW5kZXJMaXN0cyIsInNldEl0ZW0iLCJzdHJpbmdpZnkiLCJkaXJlY3RvcnlDb250YWluZXIiLCJkaXJlY3RvcnkiLCJkaXJlY3RvcnlGb2xkZXIiLCJjcmVhdGVIVE1MRWxlbWVudCIsImRhdGFzZXQiLCJsaXN0SWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJkaXJlY3RvcnlGb2xkZXJJY29ucyIsImNvbnRhaW5zIiwiZmlyc3RDaGlsZCIsInJlbW92ZUNoaWxkIiwiY3JlYXRlRGlyZWN0b3J5IiwiZSIsImRpclRleHQiLCJwcmV2ZW50RGVmYXVsdCIsImRpck5hbWUiLCJ2YWx1ZSIsImNyZWF0ZU5ld0RpciIsInB1c2giLCJzZWxlY3RlZERpcmVjdG9yeUxpc3RlbmVyIiwidGFyZ2V0IiwidGFnTmFtZSIsInRvTG93ZXJDYXNlIiwiZGVsZXRlRGlyIiwicGFyZW50RWxlbWVudCIsInJlbmRlciIsImVkaXREaXIiLCJkaXJlY3RvcnlNb2RhbCIsInRvZ2dsZSIsImVkaXREaXJCdG4iLCJjbG9zZUVkaXREaXJCdG4iLCJlZGl0RGlyRm9ybSIsImRpcmVjdG9yeU1vZGFsVGV4dCIsImRpcmVjdG9yeVJlTmFtZSIsImRpciIsInJlbW92ZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJjbG9zZUVkaXREaXIiLCJhZGRFdmVudExpc3RlbmVyIiwidHlwZSIsImNsYXNzZXMiLCJlbGVtZW50IiwiY3JlYXRlRWxlbWVudCIsIm15Q2xhc3MiLCJzZXRJbnRlcnZhbCIsImRhcmtNb2RlIiwiYm9keSIsImN1cnJlbnRUaGVtZSIsInRvZ2dsZVRoZW1lIiwiZGlyRm9ybSIsImRpckNvbnRhaW5lciIsImNyZWF0ZURpckxpc3RlbmVyIiwibGlzdE1vZGFsIiwidGFza0lucHV0TmFtZSIsInRhc2tJbnB1dERlc2MiLCJ0YXNrSW5wdXREYXRlIiwidGFza1Bvc3RlZCIsInRhc2tOYW1lIiwic2VsZWN0ZWRFbGVtZW50IiwicGFyZW50Tm9kZSIsInNlbGVjdGVkVGFzayIsIkFycmF5IiwiZnJvbSIsImNoaWxkcmVuIiwiaW5kZXhPZiIsIml0ZW1zIiwidGFza0VkaXRNb2RhbCIsInRhc2tFZGl0Rm9ybSIsInN1Ym1pdFRhc2tFZGl0IiwiY29uc29sZSIsImxvZyIsImNsb3NlRWRpdFRhc2siLCJjbG9zZUVkaXRUYXNrTW9kYWwiXSwic291cmNlUm9vdCI6IiJ9